import{r as t,b as q,d as G,j as e,M as H,T as j,B as O,ah as W,h as N}from"./index-DsMF7nGP.js";import{T as z}from"./TextField-Dd0I3wlN.js";import{F as _}from"./OutlinedInput-BXaV-Tfd.js";import{I as J,B}from"./InputLabel-ByLwqljB.js";import{S as K}from"./Select-D0SKNEq1.js";import{M as g}from"./MenuItem-CYeiS079.js";import{a as Q,b as V,c as X,d as p,T as s,e as Y}from"./TableRow-rRFZwTn7.js";import{P as Z}from"./Pagination-DsbShUyq.js";import"./FormHelperText-8d_j0jqG.js";import"./LastPage-D5xK69ll.js";const de=()=>{const[S,w]=t.useState([]),[E,b]=t.useState(!0),[f,F]=t.useState(null),[d,y]=t.useState(1),[h]=t.useState(10),[k,U]=t.useState(0),[u,A]=t.useState(""),[v,I]=t.useState(""),[m,M]=t.useState({email:"",name:""}),[x,P]=t.useState("createdAt:desc"),[R,L]=t.useState(!1),{enqueueSnackbar:C}=q(),r=G(a=>a.auth.token),D=()=>{M({email:u,name:v}),y(1)};t.useEffect(()=>{(async()=>{var n,i,o,l;console.log(r,"<===== ow wow owo wowo"),b(!0);try{const c={page:d,limit:h,email:m.email||void 0,firstName:m.name||void 0,sortBy:x||void 0},T=await N.get("/user",{params:c,headers:{Authorization:r}});w(((n=T.data.data)==null?void 0:n.results)||[]),U(((i=T.data.data)==null?void 0:i.totalResults)||0)}catch(c){F(((l=(o=c.response)==null?void 0:o.data)==null?void 0:l.message)||c.message)}finally{b(!1)}})()},[r,d,h,m,x,R]);const $=async(a,n)=>{var i,o;try{await N.patch(`/user/${a}`,{status:n},{headers:{Authorization:r}}),L(l=>!l),C(`User ${n==="enabled"?"enabled":"disabled"} successfully!`,{variant:"success"})}catch(l){C(((o=(i=l.response)==null?void 0:i.data)==null?void 0:o.message)||l.message||"Failed to update user status",{variant:"error"})}};return e.jsxs(H,{children:[e.jsx(j,{variant:"h2",mb:2,children:"User Control Panel"}),e.jsxs(O,{mb:2,display:"flex",alignItems:"center",gap:2,children:[e.jsx(z,{label:"Search by Email",size:"small",value:u,onChange:a=>A(a.target.value)}),e.jsx(z,{label:"Search by Name",size:"small",value:v,onChange:a=>I(a.target.value)}),e.jsxs(_,{size:"small",sx:{minWidth:150},children:[e.jsx(J,{children:"Sort By"}),e.jsxs(K,{value:x,label:"Sort By",onChange:a=>P(a.target.value+":asc"),children:[e.jsx(g,{value:"createdAt:desc",children:"None"}),e.jsx(g,{value:"firstName:asc",children:"Name"}),e.jsx(g,{value:"status:asc",children:"Status"})]})]}),e.jsx(B,{variant:"contained",color:"primary",onClick:D,children:"Search"})]}),E?e.jsx(j,{children:"Loading users..."}):f?e.jsx(j,{color:"error",children:f}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{children:e.jsxs(V,{size:"small",children:[e.jsx(X,{children:e.jsxs(p,{children:[e.jsx(s,{children:"Name"}),e.jsx(s,{children:"Email"}),e.jsx(s,{children:"Designation"}),e.jsx(s,{children:"Organization"}),e.jsx(s,{children:"Gender"}),e.jsx(s,{children:"Role"}),e.jsx(s,{children:"Type"}),e.jsx(s,{children:"Status"}),e.jsx(s,{children:"Action"})]})}),e.jsxs(Y,{children:[S.map(a=>e.jsxs(p,{children:[e.jsxs(s,{children:[a==null?void 0:a.firstName," ",a==null?void 0:a.lastName]}),e.jsx(s,{children:a==null?void 0:a.email}),e.jsx(s,{children:a==null?void 0:a.designation}),e.jsx(s,{children:a==null?void 0:a.organization}),e.jsx(s,{children:a==null?void 0:a.gender}),e.jsx(s,{children:a==null?void 0:a.role}),e.jsx(s,{children:a==null?void 0:a.type}),e.jsx(s,{children:e.jsx(W,{label:a.status,color:a.status==="enabled"?"success":"warning",size:"small"})}),e.jsx(s,{children:e.jsx(B,{variant:"contained",color:a.status==="enabled"?"error":"success",size:"small",onClick:()=>$(a.id,a.status!=="enabled"?"enabled":"disabled"),children:a.status==="enabled"?"Disable":"Enable"})})]},a.id)),S.length===0&&e.jsx(p,{children:e.jsx(s,{colSpan:8,align:"center",children:"No users found."})})]})]})}),e.jsx(Z,{count:Math.ceil(k/h),page:d,onChange:(a,n)=>y(n),color:"primary",sx:{mt:2,display:"flex",justifyContent:"center"}})]})]})};export{de as default};
