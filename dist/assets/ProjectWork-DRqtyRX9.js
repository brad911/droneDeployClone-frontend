import{V as Re,U as Be,t as fe,j as n,r as S,aq as Ne,ar as ie,y as me,Y as Oe,a7 as je,Z as Ue,af as Ge,as as et,at as Fe,au as Ee,av as Le,aw as We,b as tt,d as ue,ax as ot,B as Y,T as se,ay as rt,h as V,aa as st,al as ee,M as Te,az as at,aA as nt,aB as it,D as lt}from"./index-CLShbHKG.js";import{m as N}from"./mapbox-gl-CdipY_Gw.js";import{M as ct,g as Pe}from"./index-PLw5nskQ.js";import{d as pt}from"./dayjs.min-UIxm1mZV.js";import{u as dt,I as ut}from"./index-eYoZD1yq.js";import{T as He}from"./TextField-dVb_FRGK.js";import{B as le,C as qe,I as gt}from"./InputLabel-BtYDmk5J.js";import{I as Ke}from"./IconButton-Dl4YXc1J.js";import{I as ft}from"./IconBuildingCog-J3FpCQNs.js";import{u as mt,f as yt,F as ht}from"./OutlinedInput-BN7h3DEh.js";import{F as ve,C as xe}from"./FormControlLabel-DbQWwlLY.js";import{S as vt}from"./Select-BOMWSliO.js";import{M as xt}from"./MenuItem-EtgtN3AO.js";import"./FormHelperText-CSILo6Cw.js";function wt(e){return Be("MuiAlert",e)}const De=Re("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Ct=fe(n.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),bt=fe(n.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),Mt=fe(n.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),St=fe(n.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),Lt=fe(n.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),Pt=e=>{const{variant:o,color:r,severity:t,classes:a}=e,s={root:["root",`color${je(r||t)}`,`${o}${je(r||t)}`,`${o}`],icon:["icon"],message:["message"],action:["action"]};return Ue(s,wt,a)},kt=me(Ge,{name:"MuiAlert",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.root,o[r.variant],o[`${r.variant}${je(r.color||r.severity)}`]]}})(et(({theme:e})=>{const o=e.palette.mode==="light"?Fe:Ee,r=e.palette.mode==="light"?Ee:Fe;return{...e.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(Le(["light"])).map(([t])=>({props:{colorSeverity:t,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${t}Color`]:o(e.palette[t].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${t}StandardBg`]:r(e.palette[t].light,.9),[`& .${De.icon}`]:e.vars?{color:e.vars.palette.Alert[`${t}IconColor`]}:{color:e.palette[t].main}}})),...Object.entries(e.palette).filter(Le(["light"])).map(([t])=>({props:{colorSeverity:t,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${t}Color`]:o(e.palette[t].light,.6),border:`1px solid ${(e.vars||e).palette[t].light}`,[`& .${De.icon}`]:e.vars?{color:e.vars.palette.Alert[`${t}IconColor`]}:{color:e.palette[t].main}}})),...Object.entries(e.palette).filter(Le(["dark"])).map(([t])=>({props:{colorSeverity:t,variant:"filled"},style:{fontWeight:e.typography.fontWeightMedium,...e.vars?{color:e.vars.palette.Alert[`${t}FilledColor`],backgroundColor:e.vars.palette.Alert[`${t}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[t].dark:e.palette[t].main,color:e.palette.getContrastText(e.palette[t].main)}}}))]}})),jt=me("div",{name:"MuiAlert",slot:"Icon"})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),At=me("div",{name:"MuiAlert",slot:"Message"})({padding:"8px 0",minWidth:0,overflow:"auto"}),_t=me("div",{name:"MuiAlert",slot:"Action"})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),ze={success:n.jsx(Ct,{fontSize:"inherit"}),warning:n.jsx(bt,{fontSize:"inherit"}),error:n.jsx(Mt,{fontSize:"inherit"}),info:n.jsx(St,{fontSize:"inherit"})},Ie=S.forwardRef(function(o,r){const t=Ne({props:o,name:"MuiAlert"}),{action:a,children:s,className:u,closeText:p="Close",color:d,components:c={},componentsProps:y={},icon:h,iconMapping:j=ze,onClose:P,role:b="alert",severity:w="success",slotProps:O={},slots:A={},variant:G="standard",...$}=t,f={...t,color:d,severity:w,variant:G,colorSeverity:d||w},D=Pt(f),R={slots:{closeButton:c.CloseButton,closeIcon:c.CloseIcon,...A},slotProps:{...y,...O}},[B,W]=ie("root",{ref:r,shouldForwardComponentProp:!0,className:Oe(D.root,u),elementType:kt,externalForwardedProps:{...R,...$},ownerState:f,additionalProps:{role:b,elevation:0}}),[H,ae]=ie("icon",{className:D.icon,elementType:jt,externalForwardedProps:R,ownerState:f}),[ce,pe]=ie("message",{className:D.message,elementType:At,externalForwardedProps:R,ownerState:f}),[ne,Z]=ie("action",{className:D.action,elementType:_t,externalForwardedProps:R,ownerState:f}),[te,E]=ie("closeButton",{elementType:Ke,externalForwardedProps:R,ownerState:f}),[ye,de]=ie("closeIcon",{elementType:Lt,externalForwardedProps:R,ownerState:f});return n.jsxs(B,{...W,children:[h!==!1?n.jsx(H,{...ae,children:h||j[w]||ze[w]}):null,n.jsx(ce,{...pe,children:s}),a!=null?n.jsx(ne,{...Z,children:a}):null,a==null&&P?n.jsx(ne,{...Z,children:n.jsx(te,{size:"small","aria-label":p,title:p,color:"inherit",onClick:P,...E,children:n.jsx(ye,{fontSize:"small",...de})})}):null]})});function Ft(e){return Be("MuiFormGroup",e)}Re("MuiFormGroup",["root","row","error"]);const Et=e=>{const{classes:o,row:r,error:t}=e;return Ue({root:["root",r&&"row",t&&"error"]},Ft,o)},Tt=me("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.root,r.row&&o.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),Dt=S.forwardRef(function(o,r){const t=Ne({props:o,name:"MuiFormGroup"}),{className:a,row:s=!1,...u}=t,p=mt(),d=yt({props:t,muiFormControl:p,states:["error"]}),c={...t,row:s,error:d.error},y=Et(c);return n.jsx(Tt,{className:Oe(y.root,a),ownerState:c,ref:r,...u})});/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var zt=We("outline","trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var It=We("outline","x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]),U=63710088e-1,Ve={centimeters:U*100,centimetres:U*100,degrees:360/(2*Math.PI),feet:U*3.28084,inches:U*39.37,kilometers:U/1e3,kilometres:U/1e3,meters:U,metres:U,miles:U/1609.344,millimeters:U*1e3,millimetres:U*1e3,nauticalmiles:U/1852,radians:1,yards:U*1.0936};function be(e,o,r={}){const t={type:"Feature"};return(r.id===0||r.id)&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.properties=o||{},t.geometry=e,t}function Me(e,o,r={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!$e(e[0])||!$e(e[1]))throw new Error("coordinates must contain numbers");return be({type:"Point",coordinates:e},o,r)}function $t(e,o,r={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return be({type:"LineString",coordinates:e},o,r)}function Rt(e,o="kilometers"){const r=Ve[o];if(!r)throw new Error(o+" units is invalid");return e*r}function Bt(e,o="kilometers"){const r=Ve[o];if(!r)throw new Error(o+" units is invalid");return e/r}function Ae(e){return e%(2*Math.PI)*180/Math.PI}function X(e){return e%360*Math.PI/180}function $e(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function ge(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Nt(e){return e.type==="Feature"?e.geometry:e}function Ye(e,o,r={}){if(r.final===!0)return Ot(e,o);const t=ge(e),a=ge(o),s=X(t[0]),u=X(a[0]),p=X(t[1]),d=X(a[1]),c=Math.sin(u-s)*Math.cos(d),y=Math.cos(p)*Math.sin(d)-Math.sin(p)*Math.cos(d)*Math.cos(u-s);return Ae(Math.atan2(c,y))}function Ot(e,o){let r=Ye(o,e);return r=(r+180)%360,r}function Ut(e,o,r,t={}){const a=ge(e),s=X(a[0]),u=X(a[1]),p=X(r),d=Bt(o,t.units),c=Math.asin(Math.sin(u)*Math.cos(d)+Math.cos(u)*Math.sin(d)*Math.cos(p)),y=s+Math.atan2(Math.sin(p)*Math.sin(d)*Math.cos(u),Math.cos(d)-Math.sin(u)*Math.sin(c)),h=Ae(y),j=Ae(c);return Me([h,j],t.properties)}function Ze(e,o,r={}){var t=ge(e),a=ge(o),s=X(a[1]-t[1]),u=X(a[0]-t[0]),p=X(t[1]),d=X(a[1]),c=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(p)*Math.cos(d);return Rt(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),r.units)}function we(e,o,r={}){const a=Nt(e).coordinates;let s=0;for(let u=0;u<a.length&&!(o>=s&&u===a.length-1);u++)if(s>=o){const p=o-s;if(p){const d=Ye(a[u],a[u-1])-180;return Ut(a[u],p,d,r)}else return Me(a[u])}else s+=Ze(a[u],a[u+1],r);return Me(a[a.length-1])}function _e(e,o,r){if(e!==null)for(var t,a,s,u,p,d,c,y=0,h=0,j,P=e.type,b=P==="FeatureCollection",w=P==="Feature",O=b?e.features.length:1,A=0;A<O;A++){c=b?e.features[A].geometry:w?e.geometry:e,j=c?c.type==="GeometryCollection":!1,p=j?c.geometries.length:1;for(var G=0;G<p;G++){var $=0,f=0;if(u=j?c.geometries[G]:c,u!==null){d=u.coordinates;var D=u.type;switch(y=r&&(D==="Polygon"||D==="MultiPolygon")?1:0,D){case null:break;case"Point":if(o(d,h,A,$,f)===!1)return!1;h++,$++;break;case"LineString":case"MultiPoint":for(t=0;t<d.length;t++){if(o(d[t],h,A,$,f)===!1)return!1;h++,D==="MultiPoint"&&$++}D==="LineString"&&$++;break;case"Polygon":case"MultiLineString":for(t=0;t<d.length;t++){for(a=0;a<d[t].length-y;a++){if(o(d[t][a],h,A,$,f)===!1)return!1;h++}D==="MultiLineString"&&$++,D==="Polygon"&&f++}D==="Polygon"&&$++;break;case"MultiPolygon":for(t=0;t<d.length;t++){for(f=0,a=0;a<d[t].length;a++){for(s=0;s<d[t][a].length-y;s++){if(o(d[t][a][s],h,A,$,f)===!1)return!1;h++}f++}$++}break;case"GeometryCollection":for(t=0;t<u.geometries.length;t++)if(_e(u.geometries[t],o,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Gt(e,o){var r,t,a,s,u,p,d,c,y,h,j=0,P=e.type==="FeatureCollection",b=e.type==="Feature",w=P?e.features.length:1;for(r=0;r<w;r++){for(p=P?e.features[r].geometry:b?e.geometry:e,c=P?e.features[r].properties:b?e.properties:{},y=P?e.features[r].bbox:b?e.bbox:void 0,h=P?e.features[r].id:b?e.id:void 0,d=p?p.type==="GeometryCollection":!1,u=d?p.geometries.length:1,a=0;a<u;a++){if(s=d?p.geometries[a]:p,s===null){if(o(null,j,c,y,h)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(o(s,j,c,y,h)===!1)return!1;break}case"GeometryCollection":{for(t=0;t<s.geometries.length;t++)if(o(s.geometries[t],j,c,y,h)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}j++}}function Wt(e,o){Gt(e,function(r,t,a,s,u){var p=r===null?null:r.type;switch(p){case null:case"Point":case"LineString":case"Polygon":return o(be(r,a,{bbox:s,id:u}),t,0)===!1?!1:void 0}var d;switch(p){case"MultiPoint":d="Point";break;case"MultiLineString":d="LineString";break;case"MultiPolygon":d="Polygon";break}for(var c=0;c<r.coordinates.length;c++){var y=r.coordinates[c],h={type:d,coordinates:y};if(o(be(h,a),t,c)===!1)return!1}})}function Ht(e,o){Wt(e,function(r,t,a){var s=0;if(r.geometry){var u=r.geometry.type;if(!(u==="Point"||u==="MultiPoint")){var p,d=0,c=0,y=0;if(_e(r,function(h,j,P,b,w){if(p===void 0||t>d||b>c||w>y){p=h,d=t,c=b,y=w,s=0;return}var O=$t([p,h],r.properties);if(o(O,t,a,w,s)===!1)return!1;s++,p=h})===!1)return!1}}})}function qt(e,o,r){var t=r,a=!1;return Ht(e,function(s,u,p,d,c){a===!1&&r===void 0?t=s:t=o(t,s,u,p,d,c),a=!0}),t}function ke(e,o={}){let r=0,t=0,a=0;return _e(e,function(s){r+=s[0],t+=s[1],a++},!0),Me([r/a,t/a],o.properties)}function Ce(e,o={}){return qt(e,(r,t)=>{const a=t.geometry.coordinates;return r+Ze(a[0],a[1],o)},0)}const Kt=({open:e=!1,onClose:o,onSave:r})=>{const[t,a]=S.useState(null),[s,u]=S.useState(!1),[p,d]=S.useState(0),[c,y]=S.useState({date:new Date().toISOString().split("T")[0],file:null}),{enqueueSnackbar:h}=tt(),j=ue(f=>f.auth.token),P=ue(f=>f.project.selectedProjectId);S.useEffect(()=>{e||(a(null),u(!1),d(0),y({date:new Date().toISOString().split("T")[0],file:null}))},[e]);const b=(f,D)=>{y(R=>({...R,[f]:D}))},w=f=>{f.length&&(a(f[0]),b("file",f[0]))},{getRootProps:O,getInputProps:A,isDragActive:G}=dt({onDrop:w,multiple:!1,accept:{"application/zip":[".zip"]}}),$=async()=>{var f,D,R;if(!c.file){h("Please select a file to upload.",{variant:"warning"});return}u(!0),d(0);try{const W=(await V.post("/work-day/get-url",{projectId:P,name:c.date,filename:c.file.name,contentType:c.file.type,size:c.file.size},{headers:{Authorization:j}})).data.data;if(console.log(W),W.uploadType==="single")await V.put(W.url,c.file,{headers:{"Content-Type":c.file.type},onUploadProgress:H=>{const ae=Math.round(H.loaded*100/H.total);d(ae)}});else if(W.uploadType==="multipart"){const{parts:H,uploadId:ae,key:ce,partSize:pe}=W,ne=[];let Z=0;for(;Z<c.file.size;){const E=Math.min(Z+pe,c.file.size);ne.push(t.slice(Z,E)),Z=E}const te=[];for(let E=0;E<H.length;E++){const de=(f=(await fetch(H[E].url,{method:"PUT",body:ne[E]})).headers.get("ETag"))==null?void 0:f.replace(/"/g,"");te.push({PartNumber:H[E].partNumber,ETag:de});const Se=Math.round((E+1)/H.length*100);d(Se)}await V.post("/work-day/complete-upload",{projectId:P,name:c.date,key:ce,uploadId:ae,parts:te},{headers:{Authorization:j}})}h("Upload successful!",{variant:"success"}),W.uploadType==="single"&&h("SuccessFully Created Historical Data",{variant:"success"}),r&&r(),o()}catch(B){console.log(B),h(((R=(D=B==null?void 0:B.response)==null?void 0:D.data)==null?void 0:R.message)||B.message||"Upload failed.",{variant:"error"})}finally{u(!1),d(0)}};return n.jsx(ot,{open:e,onClose:o,children:n.jsxs(Y,{sx:{outline:"none",width:400,maxWidth:"90vw",bgcolor:"background.paper",borderRadius:2,boxShadow:24,mx:"auto",mt:"10vh",p:3},children:[n.jsx(se,{variant:"h5",sx:{mb:2},children:"Upload New Capture Into Historical Data"}),n.jsxs(Y,{sx:{display:"flex",flexDirection:"column",gap:2},children:[n.jsx(He,{label:"Date of Capture",type:"date",value:c.date,onChange:f=>b("date",f.target.value),fullWidth:!0,size:"small",disabled:s,InputLabelProps:{shrink:!0}}),n.jsxs(Y,{...O(),sx:{border:"2px dashed #ccc",borderRadius:"8px",padding:4,textAlign:"center",cursor:s?"not-allowed":"pointer",backgroundColor:G?"#f0f0f0":"transparent",mb:2,opacity:s?.5:1,pointerEvents:s?"none":"auto"},children:[n.jsx("input",{...A()}),n.jsx(ut,{size:32}),n.jsx(se,{variant:"h6",gutterBottom:!0,children:"Upload Zip File"}),n.jsx(se,{variant:"body2",sx:{mb:2},children:"Drag & drop your .zip file or click below to browse"}),n.jsx(le,{variant:"outlined",disabled:s,children:"Browse Files"}),t&&n.jsxs(se,{variant:"subtitle1",sx:{mt:1},children:["Selected: ",t.name]})]}),s&&n.jsxs(Y,{children:[n.jsxs(se,{variant:"body2",gutterBottom:!0,children:["Uploading... ",p,"%"]}),n.jsx(rt,{variant:"determinate",value:p})]}),n.jsxs(Y,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[n.jsx(le,{onClick:o,disabled:s,children:"Cancel"}),n.jsx(le,{variant:"contained",onClick:$,disabled:!c.file||s,startIcon:s&&n.jsx(qe,{size:16}),children:s?"Uploading...":"Upload"})]})]})]})})},Vt=({commentInput:e,setCommentInput:o,addCommentLayer:r,setCommentFeatures:t,commentFeatures:a,handleDeleteComment:s,workDay:u})=>{var c,y,h,j,P;const p=ue(b=>b.auth.token),d=async(b,w)=>{try{const O=`comment-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,A={type:"Feature",geometry:e.feature.geometry,properties:{id:O,workDayId:u.id,comment:b,type:"comment",color:e.feature.properties.color,created:new Date().toISOString()}},G={geometry:A.geometry,properties:A.properties,featureType:A.properties.type,workDayId:u.id};(await V.post("/mapFeature",G,{headers:{Authorization:p}})).status===201&&ee("Sucessfully Added Comment",{variant:"success"});const f=[...a,A];t(f),o({open:!1,feature:null,isEdit:!1,position:{x:0,y:0}}),new N.Popup().setLngLat(coordinates).setHTML(`<strong> ${b}</strong>`).addTo(mapboxMap)}catch(O){console.error(O)}};return n.jsx(st,{in:e.open,children:n.jsxs(Ge,{elevation:4,sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e3,p:1.5,width:250,backgroundColor:"#ffffff",border:"1px solid #e0e0e0",borderRadius:1.5},children:[n.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[n.jsx(se,{variant:"subtitle2",sx:{fontSize:"0.875rem"},children:e.isEdit?"Edit Comment":"Add Comment"}),n.jsx(Ke,{size:"small",onClick:()=>o({open:!1,feature:null,isEdit:!1,position:{x:0,y:0}}),sx:{p:.5},children:n.jsx(It,{size:14})})]}),n.jsx(He,{autoFocus:!0,size:"small",fullWidth:!0,variant:"outlined",multiline:!0,rows:2,placeholder:"Enter comment...",value:((y=(c=e.feature)==null?void 0:c.properties)==null?void 0:y.comment)||"",onChange:b=>{if(e.feature){const w={...e.feature,properties:{...e.feature.properties,comment:b.target.value}};o({...e,feature:w})}},sx:{mb:1}}),n.jsxs(Y,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.isEdit&&e.feature&&n.jsx(le,{size:"small",variant:"contained",color:"error",startIcon:n.jsx(zt,{size:14}),onClick:()=>{s(e.feature)},sx:{fontSize:"0.75rem",py:.5},children:"Delete"}),n.jsx(le,{size:"small",variant:"contained",onClick:()=>{var b,w;return d(((w=(b=e.feature)==null?void 0:b.properties)==null?void 0:w.comment)||"")},disabled:!((P=(j=(h=e.feature)==null?void 0:h.properties)==null?void 0:j.comment)!=null&&P.trim()),sx:{fontSize:"0.75rem",py:.5},children:e.isEdit?"Update":"Add"})]})]})})};class Yt{constructor(o){if(typeof o=="function")this.onChange=o,this.initialColor="#3bb2d0",this.initialOpacity=.2;else{const{onChange:r,initialColor:t="#3bb2d0",initialOpacity:a=.2}=o||{};this.onChange=r,this.initialColor=t,this.initialOpacity=a}this._map=null,this._container=null,this._isOpen=!1,this._color=this.initialColor,this._opacity=this.initialOpacity}onAdd(o){this._map=o;const r=document.createElement("div");r.className="mapboxgl-ctrl mapboxgl-ctrl-group",r.style.position="relative";const t=document.createElement("button");t.type="button",t.className="mapboxgl-ctrl-icon",t.setAttribute("aria-label","Color & Opacity"),t.style.width="30px",t.style.height="30px",t.style.display="inline-flex",t.style.alignItems="center",t.style.justifyContent="center";const a=document.createElement("span");a.style.width="14px",a.style.height="14px",a.style.borderRadius="50%",a.style.background=this._color,a.style.opacity=this._opacity,a.style.boxShadow="0 0 0 1px rgba(0,0,0,0.2) inset",t.appendChild(a),this._dot=a;const s=document.createElement("div");s.style.position="absolute",s.style.top="0",s.style.right="100%",s.style.marginRight="8px",s.style.display="none",s.style.flexDirection="column",s.style.gap="8px",s.style.padding="8px",s.style.background="#fff",s.style.border="1px solid rgba(0,0,0,0.15)",s.style.borderRadius="8px",s.style.boxShadow="0 2px 8px rgba(0,0,0,0.12)",s.style.zIndex="2",s.style.width="140px";const u=document.createElement("input");u.type="color",u.value=this._color,u.style.width="100%",u.addEventListener("input",y=>{this._color=y.target.value,this._update()});const p=document.createElement("div");p.style.display="flex",p.style.flexDirection="column",p.style.fontSize="12px",p.style.gap="4px";const d=document.createElement("span");d.textContent=`Opacity: ${Math.round(this._opacity*100)}%`;const c=document.createElement("input");return c.type="range",c.min="0.1",c.max="1",c.step="0.05",c.value=this._opacity,c.addEventListener("input",y=>{this._opacity=parseFloat(y.target.value),d.textContent=`Opacity: ${Math.round(this._opacity*100)}%`,this._update()}),p.appendChild(d),p.appendChild(c),s.appendChild(u),s.appendChild(p),t.addEventListener("click",y=>{y.stopPropagation(),this._isOpen=!this._isOpen,s.style.display=this._isOpen?"flex":"none"}),document.addEventListener("click",y=>{r.contains(y.target)||(this._isOpen=!1,s.style.display="none")}),r.appendChild(t),r.appendChild(s),this._container=r,r}onRemove(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._map=null}_update(){this._dot&&(this._dot.style.background=this._color,this._dot.style.opacity=this._opacity),typeof this.onChange=="function"&&this.onChange(this._color,this._opacity)}}N.accessToken="pk.eyJ1IjoiaGlyYWtyYWoiLCJhIjoiY21icXd5eHRnMDNtaTJxczcxd2RmbTZwOCJ9.P6kpsuLMDdeK2DIMJZMrmw";const Zt=[{title:"Projects",to:"/project",icon:nt},{title:"Project Name",icon:ft},{title:"Exterior(Map View)",icon:it}];function go(){const e=S.useRef(null),o=S.useRef(null),r=S.useRef(null),[t,a]=S.useState(!1),[s,u]=S.useState(""),[p,d]=S.useState({orthomosaic:!0,annotations:!0,showComments:!0,showPolygons:!0,showLineString:!0}),[c,y]=S.useState(!1),[h,j]=S.useState([]),[P,b]=S.useState([]),[w,O]=S.useState(!1),[A,G]=S.useState({}),[$,f]=S.useState(null),[D,R]=S.useState(!1),[B,W]=S.useState([]),[H,ae]=S.useState("#2563EB"),[ce,pe]=S.useState(.5),[ne,Z]=S.useState({open:!1,feature:null,isEdit:!1,position:{x:0,y:0}}),te=ue(i=>i.project.selectedProjectId),E=ue(i=>i.auth.token);S.useEffect(()=>{if(!te)return;(async()=>{var g,m,C,v,J,F,oe,k;try{O(!0),f(null);const L=((m=(g=(await V.get("/work-day",{params:{projectId:te,status:"completed"},headers:{Authorization:E}})).data)==null?void 0:g.data)==null?void 0:m.results)||[];if(j(L.map(l=>l.name)),G(L[0]),b(L),L.length>0){u(L[0].name);const l=await V.get("/mapFeature",{params:{workDayId:L[0].id},headers:{Authorization:E}});((v=(C=l.data)==null?void 0:C.data)==null?void 0:v.results.length)!==0&&W((F=(J=l.data)==null?void 0:J.data)==null?void 0:F.results)}else f("No completed work days found for this project.")}catch(M){f(((k=(oe=M.response)==null?void 0:oe.data)==null?void 0:k.message)||"Failed to load project data. Please try again."),j([]),b([])}finally{O(!1)}})()},[te,E]),S.useEffect(()=>{if(!e.current||o.current)return;if(!N.accessToken){f("Mapbox API key is not configured.");return}const i=new N.Map({container:e.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[72.5714,23.0225],zoom:15,attributionControl:!1,preserveDrawingBuffer:!0,minZoom:0,maxZoom:23}),g=H,m=ce;var C=H,v=m;const J=(F,oe)=>{const k=["coalesce",["get","user_color"],["get","color"],F],M=["coalesce",["get","user_opacity"],["get","opacity"],oe];return[{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","$type","Polygon"],["==","active","true"]],paint:{"fill-color":k,"fill-outline-color":k,"fill-opacity":M}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":k,"line-width":1}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],paint:{"line-color":k,"line-width":1}},{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","$type","Polygon"],["==","active","false"]],paint:{"fill-color":k,"fill-outline-color":k,"fill-opacity":M}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","$type","Polygon"],["==","active","false"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":k,"line-width":1}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","$type","LineString"],["==","active","false"]],paint:{"line-color":k,"line-width":2}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","false"]],paint:{"circle-radius":4,"circle-color":k}},{id:"gl-draw-point-comment",type:"circle",filter:["all",["==","active","false"],["==","meta","feature"],["==","user_type","comment"]],paint:{"circle-radius":4,"circle-color":k,"circle-stroke-color":"#fff","circle-stroke-width":2}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":6,"circle-color":k,"circle-stroke-color":k,"circle-stroke-width":2}},{id:"gl-draw-point-comment-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["==","meta","feature"],["==","user_type","comment"]],paint:{"circle-radius":6,"circle-color":k,"circle-stroke-color":"#fff","circle-stroke-width":3}}]};return i.on("load",()=>{o.current=i,a(!0),f(null),i.addControl(new N.FullscreenControl,"top-right"),i.addControl(new N.NavigationControl({visualizePitch:!0}),"top-right");const F=new N.ScaleControl({unit:"metric",maxWidth:100});i.addControl(F,"bottom-left"),setTimeout(()=>{const M=i.getContainer().querySelector(".mapboxgl-ctrl-scale");M&&(M.style.display="block",M.style.visibility="visible",M.style.opacity="1")},1e3);const oe=new Yt((M,L)=>{console.log(M,L,"<==== picked"),C=M||g,v=L||m,console.log(C,"<==== current"),ae(M),pe(L)});i.addControl(oe,"top-right");const k=new ct({userProperties:!0,displayControlsDefault:!1,controls:{polygon:!0,line_string:!0,point:!0,trash:!0},styles:J(C,v)});i.addControl(k,"top-right"),r.current=k,i.on("draw.create",async M=>{var q;const L=A.id;console.log("current Color",C,"<==== wow  wowo  wowo"),M.features.forEach(x=>{console.log(x.id,"<=== f"),k.setFeatureProperty(x.id,"color",C)});const l=(q=M.features)==null?void 0:q[0];if(l){if(o.current.__activePopup&&o.current.__activePopup.remove(),l.geometry.type==="LineString"){if(!l||l.geometry.type!=="LineString")return;const x=Ce(l,{units:"meters"}),K=we(l,x/2,{units:"meters"}).geometry.coordinates,_=`${x.toFixed(2)} m`,z=`polygon-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;l.properties.comment=_,l.properties.color=C,l.properties.id=z;try{const T={featureType:"line",geometry:l.geometry,properties:l.properties,workDayId:L};(await V.post("/mapFeature",T,{headers:{Authorization:E}})).status===201&&ee("Line created ",{variant:"success"}),console.log(K,"<=== yo"),setTimeout(()=>{const Q=new N.Popup({closeButton:!0,offset:15}).setLngLat(K).setHTML(`<strong>Length: ${_}</strong>`).addTo(o.current);o.current.__activePopup=Q},0)}catch(T){console.error(T)}ee(_,{variant:"success"})}if(l.geometry.type==="Polygon"){const x=Pe.geometry(l.geometry),K=(x/1e6).toFixed(2),_=x.toFixed(2),z=`polygon-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,T=ke(l).geometry.coordinates;k.setFeatureProperty(l.id,"id",z),l.properties.color=C,l.properties.opacity=l.properties.areaKm2=K,l.properties.areaM2=_,l.properties.id=z,l.properties.opacity=v;try{const I={featureType:"polygon",geometry:l.geometry,properties:l.properties,workDayId:L};console.log(I,"<==== payload wow"),(await V.post("/mapFeature",I,{headers:{Authorization:E}})).status===201&&ee("Polygon created ",{variant:"success"}),setTimeout(()=>{const re=new N.Popup({closeButton:!0,offset:15}).setLngLat(T).setHTML(`<strong>Area: ${_} m²</strong>`).addTo(o.current);o.current.__activePopup=re},0)}catch(I){console.error(I)}}if(l.geometry.type==="Point"){const x=i.getCanvas().getBoundingClientRect();Z({open:!0,feature:{geometry:l.geometry,properties:{color:C}},isEdit:!1,position:{x:x.width/2,y:x.height/2}})}console.log("bhrwa  agya"),k.add(l)}}),i.on("draw.update",async M=>{var q,x,K;console.log("on update"),o.current.__activePopup&&o.current.__activePopup.remove(),console.log("updating something");const L=A.id,l=(q=M.features)==null?void 0:q[0];if(l){if(M.features.forEach(_=>{k.setFeatureProperty(_.id,"color",C)}),((x=l==null?void 0:l.geometry)==null?void 0:x.type)==="Polygon"){const _=Pe.geometry(l.geometry),z=(_/1e6).toFixed(2),T=_.toFixed(2),I=ke(l).geometry.coordinates,Q=new N.Popup({closeButton:!0,offset:15}).setLngLat(I).setHTML(`<strong>Area: ${T}</strong>`).addTo(o.current);o.current.__activePopup=Q,l.properties.color=C,l.properties.areaKm2=z,l.properties.areaM2=T,l.properties.opacity=v;try{const re={featureType:"polygon",geometry:l.geometry,properties:l.properties,workDayId:L};(await V.patch(`/mapFeature/propertyId/${l==null?void 0:l.properties.id}`,re,{headers:{Authorization:E}})).status===200&&ee("Polygon Updated ",{variant:"success"})}catch(re){console.error(re)}}if(((K=l==null?void 0:l.geometry)==null?void 0:K.type)==="LineString")try{const _=Ce(l,{units:"kilometers"}),z=(_*1e3).toFixed(2),T=we(l,_/2,{units:"kilometers"}).geometry.coordinates;if(T&&!T.some(Number.isNaN)){const re=new N.Popup().setLngLat(T).setHTML(`<strong>${z} m</strong>`).addTo(i);o.current.__activePopup=re}l.properties.color=C,l.properties.lengthKm=_.toFixed(2),l.properties.lengthM=z;const I={featureType:"line",geometry:l.geometry,properties:l.properties,workDayId:L};(await V.patch(`/mapFeature/propertyId/${l==null?void 0:l.properties.id}`,I,{headers:{Authorization:E}})).status===200&&ee("Line Updated",{variant:"success"})}catch(_){console.error("Error updating line:",_)}}}),i.on("draw.delete",async M=>{console.log("on delete"),o.current.__activePopup&&o.current.__activePopup.remove();const L=M.features[0];console.log(L,"<=== my feature"),console.log("Deleted features:",M.features);try{(await V.delete(`/mapfeature/propertyId/${L.properties.id}`)).status===200&&ee("successfully removed feature",{variant:"success"})}catch(l){console.error("error removing feature",l)}}),i.on("click",M=>{var K,_;console.log("on click"),o.current.__activePopup&&o.current.__activePopup.remove();const L=["gl-draw-line-inactive","gl-draw-line-inactive.hot","gl-draw-line-active","gl-draw-line-active.hot","gl-draw-line-static","gl-draw-point-inactive","gl-draw-point-inactive.hot","gl-draw-point-active","gl-draw-point-active.hot","gl-draw-point-static","gl-draw-polygon-fill-inactive","gl-draw-polygon-fill-inactive.cold","gl-draw-polygon-fill-inactive.hot","gl-draw-polygon-fill-active","gl-draw-polygon-fill-static","gl-draw-polygon-stroke-inactive","gl-draw-polygon-stroke-inactive.cold","gl-draw-polygon-stroke-active","gl-draw-polygon-stroke-static"],l=i.getStyle().layers.map(z=>z.id).filter(z=>L.includes(z)),q=i.queryRenderedFeatures(M.point,{layers:l});if(!q.length)return;const x=q[0];if(x.geometry.type==="Point"&&x.properties.user_type==="comment"){const z=x.geometry.coordinates.slice(),T=((K=x.properties)==null?void 0:K.comment)||((_=x.properties)==null?void 0:_.user_comment)||"",I=new N.Popup().setLngLat(z).setHTML(`<strong> ${T}</strong>`).addTo(i);o.current.__activePopup=I}if(x.geometry.type==="Polygon"){console.log(x,"<=== featuer agae ");const T=Pe.geometry(x.geometry).toFixed(2),I=ke(x),Q=I.geometry.coordinates;console.log(I,"<==== centroid"),console.log(Q,"<=== coores"),new N.Popup().setLngLat(Q).setHTML(`<strong>Area: ${T} m2</strong>`).addTo(i)}if(x.geometry.type==="LineString"){console.log(x,"<==== feature line string selection");const z=Ce(x,{units:"kilometers"}),T=we(x,z/2,{units:"kilometers"}).geometry.coordinates,I=z*1e3,Q=`${I.toFixed(2)} m`;if(T&&!T.some(Number.isNaN)){const re=new N.Popup().setLngLat(T).setHTML(`<strong>${Q}</strong>`).addTo(i);o.current.__activePopup=re}ee(`Length: ${I.toFixed(2)} m`,{variant:"success"})}}),i.on("draw.selectionchange",M=>{if(M.features.length>0){const L=M.features[0];if(L.geometry.type==="LineString"){console.log(L,"<==== feature line string selection");const l=Ce(L,{units:"kilometers"}),q=we(L,l/2,{units:"kilometers"}).geometry.coordinates,x=l*1e3,K=`${x.toFixed(2)} m`;if(q&&!q.some(Number.isNaN)){const _=new N.Popup().setLngLat(q).setHTML(`<strong>${K}</strong>`).addTo(i);o.current.__activePopup=_}ee(`Length: ${x.toFixed(2)} m`,{variant:"success"})}}})}),i.on("sourcedata",F=>{var oe;(oe=F.sourceId)!=null&&oe.includes("ortho-")&&F.isSourceLoaded&&(console.log("on source data remove"),R(!1))}),()=>{i&&i.remove&&i.remove(),o.current=null,a(!1)}},[A]),S.useEffect(()=>{if(!s||!o.current||!t||!P.length)return;const i=P.find(v=>v.name===s);if(!i)return;ye(i.id);const g=r.current;o.current,g.deleteAll();const m={type:"FeatureCollection",features:B.map(v=>{const{geometry:J,properties:F}=v;return J?(console.log(F.color,"<=== incoming color"),{type:"Feature",geometry:J,properties:{...F,comment:(F==null?void 0:F.comment)||"",color:F==null?void 0:F.color,message:(F==null?void 0:F.message)||"No message set"}}):null}).filter(Boolean)};let C={...m,features:[]};p.showComments&&C.features.push(...m.features.filter(v=>v.geometry.type==="Point")),p.showLineString&&C.features.push(...m.features.filter(v=>v.geometry.type==="LineString")),p.showPolygons&&C.features.push(...m.features.filter(v=>v.geometry.type==="Polygon")),C.features.length&&(C.features=C.features.map(v=>((!v.properties.color||v.properties.color==="null")&&(v.properties.color=DEFAULT_COLOR),v)),g.add(C),g.changeMode("simple_select")),p.orthomosaic&&i.tileBaseUrl&&(console.log("nopitynope"),R(!0),de(i)),i.tileBounds&&Se(i.tileBounds)},[s,t,p,P,B,A]);const ye=i=>{const g=o.current;if(!g)return;[`ortho-${i}`,"all-features-points","all-features-lines","all-features-polygons","all-features-polygons-outline","comment-labels"].forEach(v=>{g.getLayer(v)&&(console.log("Removing layer:",v),g.removeLayer(v))}),[`ortho-${i}`,"all-features"].forEach(v=>{g.getSource(v)&&(console.log("Removing source:",v),g.removeSource(v))})},de=i=>{const g=o.current;if(!g||!i.tileBaseUrl)return;const m=`ortho-${i.id}`;try{g.getLayer(m)&&g.removeLayer(m),g.getSource(m)&&g.removeSource(m),g.addSource(m,{type:"raster",tiles:[`${i.tileBaseUrl}/{z}/{x}/{y}.png`],tileSize:256,minzoom:18,maxzoom:24});const C=g.getStyle().layers.find(v=>v.id.startsWith("gl-draw-")).id;g.addLayer({id:m,type:"raster",source:m,paint:{"raster-opacity":p.orthomosaic?1:0,"raster-brightness-min":0,"raster-brightness-max":1}},C),console.log("Raster layer added:",m,"URL:",i.tileBaseUrl),setTimeout(()=>{const v=g.getLayer(m),J=g.getSource(m);console.log("Layer check:",{layerExists:!!v,sourceExists:!!J,layerVisible:g.getLayoutProperty(m,"visibility")!=="none",paintOpacity:g.getPaintProperty(m,"raster-opacity")})},1e3),R(!1)}catch(C){console.error("Error adding tile layer:",C),f("Failed to load orthomosaic tiles."),R(!1)}},Se=i=>{const g=o.current;if(!g)return;const{north:m,south:C,east:v,west:J}=i;g.fitBounds([[J,C],[v,m]],{padding:50,maxZoom:18})},he=i=>{d(g=>({...g,[i.target.name]:i.target.checked}))},Je=i=>{u(i.target.value);const g=P.find(m=>m.name===i.target.value);G(g)},Xe=i=>{const g=o.current;if(!(!g||!t)){if(console.log("Updating comment layer with features:",i),g.getLayer("comment-points")&&(console.log("Removing existing comment layer"),g.removeLayer("comment-points")),g.getSource("comments")&&(console.log("Removing existing comment source"),g.removeSource("comments")),console.log("checking features ",i),i&&i.length>0&&p.showComments){console.log("Adding new comment layer with",i.length,"features"),g.addSource("comments",{type:"geojson",data:{type:"FeatureCollection",features:i}}),g.addLayer({id:"comment-points",type:"symbol",source:"comments",layout:{"icon-image":"marker-15","icon-size":1.5,"text-field":["get","comment"],"text-offset":[0,1.5],"text-anchor":"top"},paint:{"text-size":.5,"text-color":"#000","text-halo-color":"#fff","text-halo-width":2}});const m=g.getLayer("comment-points");m&&console.log("Comment layer added successfully with ID:",m.id)}else console.log("No features to display, comment layer removed");g.isStyleLoaded()&&g.triggerRepaint(),console.log("Comment layer update complete")}},Qe=async i=>{console.log("=== COMMENT DELETION DEBUG ==="),console.log("Attempting to delete comment",i),console.log("Current commentFeatures:",B),console.log(B[0].properties.comment),console.log(i.properties.comment);const g=B.filter(m=>m.properties.id!==i.properties.id);try{await V.delete(`/mapFeature/propertyId/${i.properties.id}`,{headers:{Authorization:E}})}catch(m){console.error(m)}console.log("Updated commentFeatures after deletion:",g),ee("Successfully Removed Comment",{variant:"success"}),W(g),refreshCommentLayer(),Z({open:!1,feature:null,isEdit:!1,position:{x:0,y:0}}),console.log("=== END DELETION DEBUG ===")};return te?n.jsxs(Te,{children:[n.jsxs(Y,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[n.jsx(se,{variant:"h1",gutterBottom:!0,children:"Exterior (Map View)"}),n.jsx(le,{variant:"contained",onClick:()=>y(!0),disabled:w,children:"Upload New"})]}),n.jsx(Kt,{open:c,onClose:()=>y(!1)}),n.jsx(at,{links:Zt,card:!0,custom:!0,rightAlign:!1}),n.jsx(lt,{sx:{my:2}}),n.jsxs(Y,{display:"flex",height:"calc(100vh - 320px)",gap:1,children:[n.jsxs(Y,{sx:{width:"250px",pr:2,height:"100%"},children:[n.jsx(se,{onClick:()=>{const i=o.current.querySourceFeatures("mapbox-gl-draw-cold"),g=o.current.querySourceFeatures("mapbox-gl-draw-hot");console.log("Cold:",i.map(m=>m.properties)),console.log("Hot:",g.map(m=>m.properties))},variant:"h3",gutterBottom:!0,children:"Layers"}),n.jsxs(Dt,{children:[n.jsx(ve,{control:n.jsx(xe,{checked:p.orthomosaic,onChange:he,name:"orthomosaic",disabled:w}),label:"Orthomosaic"}),n.jsx(ve,{control:n.jsx(xe,{checked:p.showLineString,onChange:he,name:"showLineString",disabled:w}),label:"Show Lines"}),n.jsx(ve,{control:n.jsx(xe,{checked:p.showPolygons,onChange:he,name:"showPolygons",disabled:w}),label:"Show Polygons"}),n.jsx(ve,{control:n.jsx(xe,{checked:p.showComments,onChange:he,name:"showComments",disabled:w}),label:"Show Comments"})]}),n.jsxs(ht,{fullWidth:!0,sx:{mt:3},children:[n.jsx(gt,{children:"Historical Data"}),n.jsx(vt,{value:s||"",onChange:Je,label:"Historical Data",disabled:w||h.length===0,children:h.map(i=>n.jsx(xt,{value:i,children:pt(i).format("DD-MM-YYYY")},i))})]}),w&&n.jsx(Y,{sx:{display:"flex",justifyContent:"center",mt:2},children:n.jsx(qe,{size:24})}),!w&&h.length===0&&n.jsx(Ie,{severity:"info",sx:{mt:2},children:"No historical data available for this project."})]}),n.jsx(Y,{ref:e,sx:{flex:1,borderRadius:2,overflow:"hidden",height:"100%",position:"relative",border:"1px solid #e0e0e0","& .mapboxgl-ctrl-scale":{border:"2px solid #333",borderTop:"none",color:"#333",backgroundColor:"rgba(255, 255, 255, 0.8)",padding:"2px 6px",fontSize:"12px",fontWeight:"bold"}}}),n.jsx(Vt,{addCommentLayer:Xe,setCommentFeatures:W,commentInput:ne,setCommentInput:Z,commentFeatures:B,handleDeleteComment:Qe,workDay:A})]})]}):n.jsx(Te,{children:n.jsx(Ie,{severity:"warning",children:"No project selected. Please select a project first."})})}export{go as default};
