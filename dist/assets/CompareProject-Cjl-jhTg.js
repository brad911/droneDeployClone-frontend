import{r as a,d as B,j as e,M as I,B as i,T as C,aA as M,aB as v,aF as b,h as S}from"./index-C7gx7S-r.js";import{s as W}from"./index-DBcErg_c.js";import{m as j}from"./mapbox-gl-D6gA1kPC.js";import{I as R}from"./IconBuildingCog-BlGqjDc9.js";import{F as m}from"./OutlinedInput-8RATux7h.js";import{S as p}from"./Select-CCXuLvm0.js";import{M as x}from"./MenuItem-WvMczqAh.js";j.accessToken="pk.eyJ1IjoiaGlyYWtyYWoiLCJhIjoiY21icXd5eHRnMDNtaTJxczcxd2RmbTZwOCJ9.P6kpsuLMDdeK2DIMJZMrmw";const f=({workDay:t})=>{const c=a.useRef(null);return a.useEffect(()=>{if(!c.current||!(t!=null&&t.tileBaseUrl))return;const r=new j.Map({container:c.current,style:"mapbox://styles/mapbox/satellite-v9",center:[(t.tileBounds.west+t.tileBounds.east)/2,(t.tileBounds.south+t.tileBounds.north)/2],zoom:t.tileZoomMin??15});return r.on("load",()=>{r.addSource("ortho-source",{type:"raster",tiles:[`${t.tileBaseUrl}/{z}/{x}/{y}.png`],tileSize:256}),r.addLayer({id:"ortho-layer",type:"raster",source:"ortho-source",paint:{}})}),()=>r.remove()},[t]),e.jsx(i,{ref:c,sx:{width:"100%",height:"100%"}})};function L(){const[t,c]=a.useState([]),[r,u]=a.useState(null),[l,h]=a.useState(null),d=B(s=>s.project.selectedProjectId);a.useEffect(()=>{(async()=>{try{const o=(await S.get(`/work-day?projectId=${d}&limit=1000`)).data.data.results.filter(y=>y.tileBaseUrl);c(o),o.length>=2&&(u(o[0]),h(o[1]))}catch(n){console.error("Failed to fetch workdays",n)}})()},[d]);const g=[{title:"Projects",to:"/project",icon:v},{title:"Project Name",to:`/project/${d}/View`,icon:R},{title:"Compare View",icon:b}];return e.jsxs(I,{children:[e.jsx(i,{sx:{justifyContent:"space-between",alignItems:"center"},children:e.jsx(C,{variant:"h1",gutterBottom:!0,children:"Compare View"})}),e.jsx(i,{justifyContent:"left",children:e.jsx(M,{links:g,card:!0,custom:!0,rightAlign:!1})}),e.jsxs(i,{display:"flex",gap:2,mb:3,children:[e.jsx(m,{fullWidth:!0,children:e.jsx(p,{value:(r==null?void 0:r.id)||"",onChange:s=>{const n=t.find(o=>o.id===s.target.value);u(n)},children:t.map(s=>e.jsx(x,{value:s.id,children:s.name},s.id))})}),e.jsx(m,{fullWidth:!0,children:e.jsx(p,{value:(l==null?void 0:l.id)||"",onChange:s=>{const n=t.find(o=>o.id===s.target.value);h(n)},children:t.map(s=>e.jsx(x,{value:s.id,children:s.name},s.id))})})]}),e.jsx(i,{mb:5,borderRadius:2,overflow:"hidden",sx:{height:500},children:r&&l&&e.jsx(W,{itemOne:e.jsx(i,{sx:{width:"100%",height:"100%"},children:e.jsx(f,{workDay:r})}),itemTwo:e.jsx(i,{sx:{width:"100%",height:"100%"},children:e.jsx(f,{workDay:l})}),style:{height:"100%"}})})]})}export{L as default};
