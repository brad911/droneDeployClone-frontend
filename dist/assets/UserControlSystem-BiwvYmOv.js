import{z as J,j as e,b as R,r as t,b3 as K,b4 as Q,D as V,b5 as X,T as j,G as N,C as Z,b6 as ee,k as b,l as F,d as se,N as ae,B as T,W as U,F as te,I as ne,x as re,M as k,bf as ie,bg as le,bh as oe,bi as A,ba as a,bj as ce,a3 as de,aC as he,i as me,Y as xe}from"./index-BS7x6V1Y.js";import{F as ue}from"./FormGroup-Bg8-iQtJ.js";import{F as je}from"./FormControlLabel-R-p6A0dE.js";const be=J(e.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),ge=({open:f,onClose:c,user:o,onSave:g})=>{const{enqueueSnackbar:d}=R(),[h,m]=t.useState(o.permissions||{}),p=n=>{m(S=>({...S,[n]:!S[n]}))},x=async()=>{try{await F.patch(`/user//updatePersmission/${o.id}`,{permissions:h}),d("Permissions updated successfully!",{variant:"success"}),g(),c()}catch(n){console.log(n),d("Failed to update permissions",{variant:"error"})}};return e.jsxs(K,{open:f,onClose:c,fullWidth:!0,maxWidth:"sm",children:[e.jsx(Q,{children:"Change Permissions"}),e.jsx(V,{}),e.jsxs(X,{children:[e.jsxs(j,{variant:"h3",gutterBottom:!0,children:[o.firstName," ",o.lastName]}),e.jsx(ue,{children:e.jsxs(N,{container:!0,justifyContent:"center",alignContent:"center",alignItems:"center",spacing:2,children:[Object.keys(h).map(n=>e.jsx(N,{item:!0,xs:6,minWidth:200,children:e.jsx(je,{control:e.jsx(Z,{checked:h[n],onChange:()=>p(n)}),label:n})},n)),e.jsx(N,{item:!0,xs:6,minWidth:200},"yolo")]})})]}),e.jsxs(ee,{children:[e.jsx(b,{onClick:c,children:"Cancel"}),e.jsx(b,{variant:"contained",onClick:x,children:"Save"})]})]})},fe=()=>{const[f,c]=t.useState([]),[o,g]=t.useState(!0),[d,h]=t.useState(null),[m,p]=t.useState(1),[x]=t.useState(10),[n,S]=t.useState(0),[P,W]=t.useState(""),[B,O]=t.useState(""),[y,L]=t.useState({email:"",name:""}),[v,G]=t.useState("createdAt:desc"),[$,I]=t.useState(!1),[w,q]=t.useState(null),[H,E]=t.useState(!1),{enqueueSnackbar:D}=R(),z=se(s=>s.auth.token),Y=()=>{L({email:P,name:B}),p(1)};t.useEffect(()=>{(async()=>{var r,i,u,l;g(!0);try{const C={page:m,limit:x,email:y.email||void 0,firstName:y.name||void 0,sortBy:v||void 0},M=await F.get("/user",{params:C,headers:{Authorization:z}});c(((r=M.data.data)==null?void 0:r.results)||[]),S(((i=M.data.data)==null?void 0:i.totalResults)||0)}catch(C){h(((l=(u=C.response)==null?void 0:u.data)==null?void 0:l.message)||C.message)}finally{g(!1)}})()},[z,m,x,y,v,$]);const _=async(s,r)=>{var i,u;try{await F.patch(`/user/${s}`,{status:r},{headers:{Authorization:z}}),I(l=>!l),D(`User ${r==="enabled"?"enabled":"disabled"} successfully!`,{variant:"success"})}catch(l){D(((u=(i=l.response)==null?void 0:i.data)==null?void 0:u.message)||l.message||"Failed to update user status",{variant:"error"})}};return e.jsxs(ae,{children:[e.jsx(j,{variant:"h2",mb:2,children:"User Control Panel"}),e.jsxs(T,{mb:2,display:"flex",alignItems:"center",gap:2,children:[e.jsx(U,{label:"Search by Email",size:"small",value:P,onChange:s=>W(s.target.value)}),e.jsx(U,{label:"Search by Name",size:"small",value:B,onChange:s=>O(s.target.value)}),e.jsxs(te,{size:"small",sx:{minWidth:150},children:[e.jsx(ne,{children:"Sort By"}),e.jsxs(re,{value:v,label:"Sort By",onChange:s=>G(s.target.value+":asc"),children:[e.jsx(k,{value:"createdAt:desc",children:"None"}),e.jsx(k,{value:"firstName:asc",children:"Name"}),e.jsx(k,{value:"status:asc",children:"Status"})]})]}),e.jsx(b,{variant:"contained",color:"primary",onClick:Y,children:"Search"})]}),o?e.jsx(j,{children:"Loading users..."}):d?e.jsx(j,{color:"error",children:d}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{children:e.jsxs(le,{size:"small",children:[e.jsx(oe,{children:e.jsxs(A,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Designation"}),e.jsx(a,{children:"Organization"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Type"}),e.jsx(a,{children:"Status"}),e.jsx(a,{align:"center",children:"Action"})]})}),e.jsx(ce,{children:f.map(s=>e.jsxs(A,{children:[e.jsxs(a,{children:[s.firstName," ",s.lastName]}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.designation}),e.jsx(a,{children:s.organization}),e.jsx(a,{children:s.role}),e.jsx(a,{children:s.type}),e.jsx(a,{children:e.jsx(de,{label:s.status,color:s.status==="enabled"?"success":"warning",size:"small"})}),e.jsx(a,{align:"center",justifyContent:"center",children:e.jsxs(T,{gap:1,display:"flex",justifyContent:"center",children:[e.jsx(he,{title:e.jsx(T,{children:Object.entries(s.permissions||{}).map(([r,i])=>e.jsxs(j,{variant:"caption",display:"block",children:[r,": ",i?"✅":"❌"]},r))}),arrow:!0,componentsProps:{tooltip:{sx:{bgcolor:"white",color:"black",boxShadow:1,borderRadius:1,fontSize:"0.75rem"}},arrow:{sx:{color:"white"}}},children:e.jsx(me,{size:"small",color:"primary",children:e.jsx(be,{})})}),e.jsx(b,{size:"small",variant:"outlined",onClick:()=>{q(s),E(!0)},children:"Change"}),e.jsx(b,{variant:"contained",color:s.status==="enabled"?"error":"success",size:"small",onClick:()=>_(s.id,s.status!=="enabled"?"enabled":"disabled"),children:s.status==="enabled"?"Disable":"Enable"})]})})]},s.id))})]})}),e.jsx(xe,{count:Math.ceil(n/x),page:m,onChange:(s,r)=>p(r),color:"primary",sx:{mt:2,display:"flex",justifyContent:"center"}})]}),w&&e.jsx(ge,{open:H,onClose:()=>E(!1),user:w,onSave:()=>I(s=>!s)})]})};export{fe as default};
