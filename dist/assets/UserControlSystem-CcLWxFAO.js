import{t as K,j as e,b as R,r as t,D as Q,T as j,G as T,h as B,d as V,M as X,B as F,ah as Y,aF as Z}from"./index-B3qUXRAV.js";import{a as ee,b as se,D as ae}from"./DialogContent-CXJjDJKw.js";import{D as te}from"./DialogTitle-T7hrOul0.js";import{F as ne}from"./FormGroup-CRd6JZE0.js";import{F as re,C as ie}from"./FormControlLabel-aHygUa4K.js";import{B as p,I as le}from"./InputLabel-aQBoxI21.js";import{T as U}from"./TextField-DKxXZjVI.js";import{F as oe}from"./OutlinedInput-BYYlpLgi.js";import{S as ce}from"./Select-BV9zborq.js";import{M as P}from"./MenuItem-RZIFcSIu.js";import{a as de,b as he,c as me,d as A,T as a,e as xe}from"./TableRow-OqramLJL.js";import{I as ue}from"./IconButton-Cpfr-B-N.js";import{P as je}from"./Pagination-YGHtLzc0.js";import"./FormHelperText-CqKLb3EX.js";import"./LastPage-EBqEbqoh.js";const pe=K(e.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),ge=({open:C,onClose:c,user:o,onSave:g})=>{const{enqueueSnackbar:d}=R(),[h,m]=t.useState(o.permissions||{}),b=n=>{m(S=>({...S,[n]:!S[n]}))},x=async()=>{try{await B.patch(`/user//updatePersmission/${o.id}`,{permissions:h}),d("Permissions updated successfully!",{variant:"success"}),g(),c()}catch(n){console.log(n),d("Failed to update permissions",{variant:"error"})}};return e.jsxs(ee,{open:C,onClose:c,fullWidth:!0,maxWidth:"sm",children:[e.jsx(te,{children:"Change Permissions"}),e.jsx(Q,{}),e.jsxs(se,{children:[e.jsxs(j,{variant:"h3",gutterBottom:!0,children:[o.firstName," ",o.lastName]}),e.jsx(ne,{children:e.jsxs(T,{container:!0,justifyContent:"center",alignContent:"center",alignItems:"center",spacing:2,children:[Object.keys(h).map(n=>e.jsx(T,{item:!0,xs:6,minWidth:200,children:e.jsx(re,{control:e.jsx(ie,{checked:h[n],onChange:()=>b(n)}),label:n})},n)),e.jsx(T,{item:!0,xs:6,minWidth:200},"yolo")]})})]}),e.jsxs(ae,{children:[e.jsx(p,{onClick:c,children:"Cancel"}),e.jsx(p,{variant:"contained",onClick:x,children:"Save"})]})]})},we=()=>{const[C,c]=t.useState([]),[o,g]=t.useState(!0),[d,h]=t.useState(null),[m,b]=t.useState(1),[x]=t.useState(10),[n,S]=t.useState(0),[N,O]=t.useState(""),[k,W]=t.useState(""),[y,L]=t.useState({email:"",name:""}),[v,G]=t.useState("createdAt:desc"),[$,I]=t.useState(!1),[D,q]=t.useState(null),[H,w]=t.useState(!1),{enqueueSnackbar:E}=R(),z=V(s=>s.auth.token),_=()=>{L({email:N,name:k}),b(1)};t.useEffect(()=>{(async()=>{var r,i,u,l;g(!0);try{const f={page:m,limit:x,email:y.email||void 0,firstName:y.name||void 0,sortBy:v||void 0},M=await B.get("/user",{params:f,headers:{Authorization:z}});c(((r=M.data.data)==null?void 0:r.results)||[]),S(((i=M.data.data)==null?void 0:i.totalResults)||0)}catch(f){h(((l=(u=f.response)==null?void 0:u.data)==null?void 0:l.message)||f.message)}finally{g(!1)}})()},[z,m,x,y,v,$]);const J=async(s,r)=>{var i,u;try{await B.patch(`/user/${s}`,{status:r},{headers:{Authorization:z}}),I(l=>!l),E(`User ${r==="enabled"?"enabled":"disabled"} successfully!`,{variant:"success"})}catch(l){E(((u=(i=l.response)==null?void 0:i.data)==null?void 0:u.message)||l.message||"Failed to update user status",{variant:"error"})}};return e.jsxs(X,{children:[e.jsx(j,{variant:"h2",mb:2,children:"User Control Panel"}),e.jsxs(F,{mb:2,display:"flex",alignItems:"center",gap:2,children:[e.jsx(U,{label:"Search by Email",size:"small",value:N,onChange:s=>O(s.target.value)}),e.jsx(U,{label:"Search by Name",size:"small",value:k,onChange:s=>W(s.target.value)}),e.jsxs(oe,{size:"small",sx:{minWidth:150},children:[e.jsx(le,{children:"Sort By"}),e.jsxs(ce,{value:v,label:"Sort By",onChange:s=>G(s.target.value+":asc"),children:[e.jsx(P,{value:"createdAt:desc",children:"None"}),e.jsx(P,{value:"firstName:asc",children:"Name"}),e.jsx(P,{value:"status:asc",children:"Status"})]})]}),e.jsx(p,{variant:"contained",color:"primary",onClick:_,children:"Search"})]}),o?e.jsx(j,{children:"Loading users..."}):d?e.jsx(j,{color:"error",children:d}):e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsxs(he,{size:"small",children:[e.jsx(me,{children:e.jsxs(A,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Designation"}),e.jsx(a,{children:"Organization"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Type"}),e.jsx(a,{children:"Status"}),e.jsx(a,{align:"center",children:"Action"})]})}),e.jsx(xe,{children:C.map(s=>e.jsxs(A,{children:[e.jsxs(a,{children:[s.firstName," ",s.lastName]}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.designation}),e.jsx(a,{children:s.organization}),e.jsx(a,{children:s.role}),e.jsx(a,{children:s.type}),e.jsx(a,{children:e.jsx(Y,{label:s.status,color:s.status==="enabled"?"success":"warning",size:"small"})}),e.jsx(a,{align:"center",justifyContent:"center",children:e.jsxs(F,{gap:1,display:"flex",justifyContent:"center",children:[e.jsx(Z,{title:e.jsx(F,{children:Object.entries(s.permissions||{}).map(([r,i])=>e.jsxs(j,{variant:"caption",display:"block",children:[r,": ",i?"✅":"❌"]},r))}),arrow:!0,componentsProps:{tooltip:{sx:{bgcolor:"white",color:"black",boxShadow:1,borderRadius:1,fontSize:"0.75rem"}},arrow:{sx:{color:"white"}}},children:e.jsx(ue,{size:"small",color:"primary",children:e.jsx(pe,{})})}),e.jsx(p,{size:"small",variant:"outlined",onClick:()=>{q(s),w(!0)},children:"Change"}),e.jsx(p,{variant:"contained",color:s.status==="enabled"?"error":"success",size:"small",onClick:()=>J(s.id,s.status!=="enabled"?"enabled":"disabled"),children:s.status==="enabled"?"Disable":"Enable"})]})})]},s.id))})]})}),e.jsx(je,{count:Math.ceil(n/x),page:m,onChange:(s,r)=>b(r),color:"primary",sx:{mt:2,display:"flex",justifyContent:"center"}})]}),D&&e.jsx(ge,{open:H,onClose:()=>w(!1),user:D,onSave:()=>I(s=>!s)})]})};export{we as default};
