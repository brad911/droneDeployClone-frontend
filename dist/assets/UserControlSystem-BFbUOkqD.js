import{y as X,j as e,b as R,r as t,ay as _,bj as J,D as Q,aA as Y,T as j,G as T,C as Z,au as ee,i as b,k as N,d as se,K as ae,B as k,V as U,F as te,I as ne,w as re,M as F,br as ie,bs as le,bt as oe,bu as A,bn as a,bv as ce,aw as de,b0 as he,h as me,X as xe}from"./index-q9geJBwq.js";import{F as ue}from"./FormGroup-Be6fE8mq.js";import{F as je}from"./FormControlLabel-BO8tUw5i.js";const be=X(e.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),ge=({open:C,onClose:c,user:o,onSave:g})=>{const{enqueueSnackbar:d}=R(),[h,m]=t.useState(o.permissions||{}),p=n=>{m(S=>({...S,[n]:!S[n]}))},x=async()=>{try{await N.patch(`/user//updatePersmission/${o.id}`,{permissions:h}),d("Permissions updated successfully!",{variant:"success"}),g(),c()}catch(n){console.log(n),d("Failed to update permissions",{variant:"error"})}};return e.jsxs(_,{open:C,onClose:c,fullWidth:!0,maxWidth:"sm",children:[e.jsx(J,{children:"Change Permissions"}),e.jsx(Q,{}),e.jsxs(Y,{children:[e.jsxs(j,{variant:"h3",gutterBottom:!0,children:[o.firstName," ",o.lastName]}),e.jsx(ue,{children:e.jsxs(T,{container:!0,justifyContent:"center",alignContent:"center",alignItems:"center",spacing:2,children:[Object.keys(h).map(n=>e.jsx(T,{item:!0,xs:6,minWidth:200,children:e.jsx(je,{control:e.jsx(Z,{checked:h[n],onChange:()=>p(n)}),label:n})},n)),e.jsx(T,{item:!0,xs:6,minWidth:200},"yolo")]})})]}),e.jsxs(ee,{children:[e.jsx(b,{onClick:c,children:"Cancel"}),e.jsx(b,{variant:"contained",onClick:x,children:"Save"})]})]})},Ce=()=>{const[C,c]=t.useState([]),[o,g]=t.useState(!0),[d,h]=t.useState(null),[m,p]=t.useState(1),[x]=t.useState(10),[n,S]=t.useState(0),[P,O]=t.useState(""),[w,W]=t.useState(""),[f,L]=t.useState({email:"",name:""}),[v,G]=t.useState("createdAt:desc"),[$,B]=t.useState(!1),[I,q]=t.useState(null),[H,E]=t.useState(!1),{enqueueSnackbar:D}=R(),z=se(s=>s.auth.token),K=()=>{L({email:P,name:w}),p(1)};t.useEffect(()=>{(async()=>{var r,i,u,l;g(!0);try{const y={page:m,limit:x,email:f.email||void 0,firstName:f.name||void 0,sortBy:v||void 0},M=await N.get("/user",{params:y,headers:{Authorization:z}});c(((r=M.data.data)==null?void 0:r.results)||[]),S(((i=M.data.data)==null?void 0:i.totalResults)||0)}catch(y){h(((l=(u=y.response)==null?void 0:u.data)==null?void 0:l.message)||y.message)}finally{g(!1)}})()},[z,m,x,f,v,$]);const V=async(s,r)=>{var i,u;try{await N.patch(`/user/${s}`,{status:r},{headers:{Authorization:z}}),B(l=>!l),D(`User ${r==="enabled"?"enabled":"disabled"} successfully!`,{variant:"success"})}catch(l){D(((u=(i=l.response)==null?void 0:i.data)==null?void 0:u.message)||l.message||"Failed to update user status",{variant:"error"})}};return e.jsxs(ae,{children:[e.jsx(j,{variant:"h2",mb:2,children:"User Control Panel"}),e.jsxs(k,{mb:2,display:"flex",alignItems:"center",gap:2,children:[e.jsx(U,{label:"Search by Email",size:"small",value:P,onChange:s=>O(s.target.value)}),e.jsx(U,{label:"Search by Name",size:"small",value:w,onChange:s=>W(s.target.value)}),e.jsxs(te,{size:"small",sx:{minWidth:150},children:[e.jsx(ne,{children:"Sort By"}),e.jsxs(re,{value:v,label:"Sort By",onChange:s=>G(s.target.value+":asc"),children:[e.jsx(F,{value:"createdAt:desc",children:"None"}),e.jsx(F,{value:"firstName:asc",children:"Name"}),e.jsx(F,{value:"status:asc",children:"Status"})]})]}),e.jsx(b,{variant:"contained",color:"primary",onClick:K,children:"Search"})]}),o?e.jsx(j,{children:"Loading users..."}):d?e.jsx(j,{color:"error",children:d}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{children:e.jsxs(le,{size:"small",children:[e.jsx(oe,{children:e.jsxs(A,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Designation"}),e.jsx(a,{children:"Organization"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Type"}),e.jsx(a,{children:"Status"}),e.jsx(a,{align:"center",children:"Action"})]})}),e.jsx(ce,{children:C.map(s=>e.jsxs(A,{children:[e.jsxs(a,{children:[s.firstName," ",s.lastName]}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.designation}),e.jsx(a,{children:s.organization}),e.jsx(a,{children:s.role}),e.jsx(a,{children:s.type}),e.jsx(a,{children:e.jsx(de,{label:s.status,color:s.status==="enabled"?"success":"warning",size:"small"})}),e.jsx(a,{align:"center",justifyContent:"center",children:e.jsxs(k,{gap:1,display:"flex",justifyContent:"center",children:[e.jsx(he,{title:e.jsx(k,{children:Object.entries(s.permissions||{}).map(([r,i])=>e.jsxs(j,{variant:"caption",display:"block",children:[r,": ",i?"✅":"❌"]},r))}),arrow:!0,componentsProps:{tooltip:{sx:{bgcolor:"white",color:"black",boxShadow:1,borderRadius:1,fontSize:"0.75rem"}},arrow:{sx:{color:"white"}}},children:e.jsx(me,{size:"small",color:"primary",children:e.jsx(be,{})})}),e.jsx(b,{size:"small",variant:"outlined",onClick:()=>{q(s),E(!0)},children:"Change"}),e.jsx(b,{variant:"contained",color:s.status==="enabled"?"error":"success",size:"small",onClick:()=>V(s.id,s.status!=="enabled"?"enabled":"disabled"),children:s.status==="enabled"?"Disable":"Enable"})]})})]},s.id))})]})}),e.jsx(xe,{count:Math.ceil(n/x),page:m,onChange:(s,r)=>p(r),color:"primary",sx:{mt:2,display:"flex",justifyContent:"center"}})]}),I&&e.jsx(ge,{open:H,onClose:()=>E(!1),user:I,onSave:()=>B(s=>!s)})]})};export{Ce as default};
