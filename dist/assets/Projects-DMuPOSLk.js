import{t as E,j as e,a as B,c as Y,C as H,B as b,T as D,E as V,S as I,F as R,i as G,d as $,r as j,G as m,h as U}from"./index-BLy9ZLZ-.js";import{A as q}from"./Add-CyailjIL.js";import{P as J}from"./Person-CwLzFEd-.js";import{C as K}from"./CardMedia-CGxSIlH3.js";import{t as w,c as Q,n as z,g as X,a as Z,e as ee,m as N,b as C}from"./en-US-CRQByS1p.js";import{e as te,a as ne}from"./endOfMonth-4FTE1eXr.js";import{B as P,I as se}from"./InputLabel-HXpEqKZ-.js";import{T as re}from"./TextField-Bk6Jrq2q.js";import{F as ae}from"./OutlinedInput-plb3PIeX.js";import{S as ie}from"./Select-Nt7Xxr__.js";import{M as k}from"./MenuItem-Co4muxbj.js";import{P as ce}from"./Pagination-BSdq-J5M.js";import"./FormHelperText-_XPFxAT3.js";import"./LastPage-CT58xXwA.js";const oe=E(e.jsx("path",{d:"M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2m-11-4 2.03 2.71L16 11l4 5H8zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6z"}));function T(t,r){const n=+w(t)-+w(r);return n<0?-1:n>0?1:n}function le(t){return Q(t,Date.now())}function ue(t,r,n){const[i,s]=z(n==null?void 0:n.in,t,r),c=i.getFullYear()-s.getFullYear(),u=i.getMonth()-s.getMonth();return c*12+u}function de(t){return r=>{const i=(t?Math[t]:Math.trunc)(r);return i===0?0:i}}function fe(t,r){return+w(t)-+w(r)}function me(t,r){const n=w(t,r==null?void 0:r.in);return+te(n,r)==+ne(n,r)}function he(t,r,n){const[i,s,c]=z(n==null?void 0:n.in,t,t,r),u=T(s,c),a=Math.abs(ue(s,c));if(a<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-u*a);let x=T(s,c)===-u;me(i)&&a===1&&T(i,c)===1&&(x=!1);const g=u*(a-+x);return g===0?0:g}function xe(t,r,n){const i=fe(t,r)/1e3;return de(n==null?void 0:n.roundingMethod)(i)}function ge(t,r,n){const i=Z(),s=(n==null?void 0:n.locale)??i.locale??ee,c=2520,u=T(t,r);if(isNaN(u))throw new RangeError("Invalid time value");const a=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:u}),[x,g]=z(n==null?void 0:n.in,...u>0?[r,t]:[t,r]),h=xe(g,x),p=(X(g)-X(x))/1e3,o=Math.round((h-p)/60);let f;if(o<2)return n!=null&&n.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,a):h<10?s.formatDistance("lessThanXSeconds",10,a):h<20?s.formatDistance("lessThanXSeconds",20,a):h<40?s.formatDistance("halfAMinute",0,a):h<60?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",1,a):o===0?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",o,a);if(o<45)return s.formatDistance("xMinutes",o,a);if(o<90)return s.formatDistance("aboutXHours",1,a);if(o<N){const d=Math.round(o/60);return s.formatDistance("aboutXHours",d,a)}else{if(o<c)return s.formatDistance("xDays",1,a);if(o<C){const d=Math.round(o/N);return s.formatDistance("xDays",d,a)}else if(o<C*2)return f=Math.round(o/C),s.formatDistance("aboutXMonths",f,a)}if(f=he(g,x),f<12){const d=Math.round(o/C);return s.formatDistance("xMonths",d,a)}else{const d=f%12,M=Math.trunc(f/12);return d<3?s.formatDistance("aboutXYears",M,a):d<9?s.formatDistance("overXYears",M,a):s.formatDistance("almostXYears",M+1,a)}}function je(t,r){return ge(t,le(t),r)}const De="/assets/conture-map-DVTY2EDp.jpg",Me=({project:t,count:r})=>{const n=B(),i=Y(),s=()=>{const c=t._id||t.id;i(R(c)),n(`/project/${c}/View`)};return e.jsxs(H,{elevation:4,sx:{maxHeight:220,position:"relative",width:320,maxWidth:320,borderRadius:3,overflow:"hidden",cursor:"pointer",transition:"0.3s","&:hover":{boxShadow:6}},onClick:s,children:[e.jsxs(b,{sx:{position:"relative",height:140},children:[e.jsx(K,{component:"img",height:"140",image:De,alt:t==null?void 0:t.name,sx:{objectFit:"cover",filter:"brightness(60%)"}}),e.jsx(b,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",px:2},children:e.jsx(D,{variant:"subtitle1",fontWeight:700,color:"white",noWrap:!0,children:t==null?void 0:t.name})})]}),e.jsx(V,{sx:{pt:1,pb:1},children:e.jsxs(I,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(I,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(I,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(oe,{fontSize:"small"}),e.jsx(D,{variant:"caption",children:t.location})]}),e.jsxs(I,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(J,{fontSize:"small"}),e.jsx(D,{variant:"caption",children:r})]}),e.jsx(I,{children:e.jsx(D,{variant:"caption",fontSize:8,color:"text.secondary",children:t.createdAt?`${je(new Date(t.createdAt),{addSuffix:!0})}`:"Time unknown"})})]}),e.jsx(P,{size:"small",onClick:c=>{c.stopPropagation(),s()},children:"View"})]})})]})};function ke(){const t=G(),r=B(),n=$(l=>l.auth),[i,s]=j.useState(""),[c,u]=j.useState(""),[a,x]=j.useState([]),[g,h]=j.useState(!1),[p,o]=j.useState(null),[f,d]=j.useState(1),[M,O]=j.useState(1),L=12,F=async(l="",S="",_=1)=>{var A;h(!0),o(null);try{const v={email:n.user.email,status:"active",page:_,limit:L};l&&(v.search=l),S&&(v.sortBy=S);const y=(A=(await U.get("/project-members",{params:v,headers:{Authorization:n.token}})).data)==null?void 0:A.data;x((y==null?void 0:y.results)||[]),O((y==null?void 0:y.totalPages)||1)}catch(v){o(v.message||"Failed to fetch projects")}finally{h(!1)}};j.useEffect(()=>{F(i,c,f)},[f]);const W=()=>{d(1),F(i,c,1)};return e.jsxs(b,{p:3,children:[e.jsxs(m,{container:!0,spacing:2,alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsx(m,{item:!0,xs:12,md:3,children:e.jsx(D,{variant:"h2",fontWeight:600,children:"All Projects"})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsxs(m,{container:!0,justifyContent:"center",alignItems:"center",spacing:2,children:[e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(re,{label:"Search by Name",variant:"outlined",size:"small",fullWidth:!0,value:i,onChange:l=>s(l.target.value)})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsxs(ae,{sx:{...t.typography.customSelect2,minWidth:"100px"},fullWidth:!0,children:[e.jsx(se,{children:"Sort By"}),e.jsxs(ie,{size:"small",value:c,label:"Sort By",onChange:l=>u(l.target.value),children:[e.jsx(k,{value:"name",children:"Name"}),e.jsx(k,{value:"images",children:"Date"})]})]})}),e.jsx(m,{item:!0,xs:12,sm:2,children:e.jsx(P,{variant:"contained",fullWidth:!0,onClick:W,children:"Search"})})]})}),e.jsx(m,{item:!0,xs:12,md:3,textAlign:{xs:"left",md:"right"},children:e.jsx(P,{variant:"contained",onClick:()=>r("/createProject"),startIcon:e.jsx(q,{}),color:"primary",children:"Create New Project"})})]}),g?e.jsx(D,{variant:"body1",children:"Loading projects..."}):p?e.jsx(D,{color:"error",children:p}):a.length===0?e.jsx(b,{mt:6,textAlign:"center",children:e.jsx(D,{variant:"h6",color:"text.secondary",children:"No projects found. Create a project to start working."})}):e.jsxs(e.Fragment,{children:[e.jsx(m,{container:!0,spacing:3,children:a.map((l,S)=>e.jsx(m,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(Me,{project:l.projectId,count:l.memberCount})},S))}),M>1&&e.jsx(b,{mt:4,display:"flex",justifyContent:"center",children:e.jsx(ce,{count:M,page:f,onChange:(l,S)=>d(S),color:"primary"})})]})]})}export{ke as default};
