import{E as K,j as e,b as R,r as t,Y as Q,Z as Y,D as Z,_ as V,T as j,G as N,k as X,C as ee,$ as se,l as g,m as k,d as ae,Q as te,B as P,a1 as U,F as ne,I as re,y as ie,M as T,aI as le,aJ as oe,aK as ce,aL as A,aM as a,aN as de,ab as he,aP as me,i as xe,a3 as ue}from"./index-a-t0JUrB.js";import{F as je}from"./FormGroup-DkfYBIeb.js";const ge=K(e.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),pe=({open:y,onClose:d,user:o,onSave:p})=>{const{enqueueSnackbar:h}=R(),[c,m]=t.useState(o.permissions||{}),b=n=>{m(S=>({...S,[n]:!S[n]}))},x=async()=>{console.log(c,"<======permissions to submit");try{await k.patch(`/user/updatePersmission/${o.id}`,{permissions:c}),h("Permissions updated successfully!",{variant:"success"}),p(),d()}catch(n){console.log(n),h("Failed to update permissions",{variant:"error"})}};return e.jsxs(Q,{open:y,onClose:d,fullWidth:!0,maxWidth:"sm",children:[e.jsx(Y,{children:"Change Permissions"}),e.jsx(Z,{}),e.jsxs(V,{children:[e.jsxs(j,{variant:"h3",gutterBottom:!0,children:[o.firstName," ",o.lastName]}),e.jsx(je,{children:e.jsxs(N,{container:!0,justifyContent:"center",alignContent:"center",alignItems:"center",spacing:2,children:[Object.keys(c).map(n=>e.jsx(N,{item:!0,xs:6,minWidth:200,children:e.jsx(X,{control:e.jsx(ee,{checked:c[n],onChange:()=>b(n)}),label:n})},n)),e.jsx(N,{item:!0,xs:6,minWidth:200},"yolo")]})})]}),e.jsxs(se,{children:[e.jsx(g,{onClick:d,children:"Cancel"}),e.jsx(g,{variant:"contained",onClick:x,children:"Save"})]})]})},Ce=()=>{const[y,d]=t.useState([]),[o,p]=t.useState(!0),[h,c]=t.useState(null),[m,b]=t.useState(1),[x]=t.useState(10),[n,S]=t.useState(0),[B,L]=t.useState(""),[F,O]=t.useState(""),[f,W]=t.useState({email:"",name:""}),[v,$]=t.useState("createdAt:desc"),[G,I]=t.useState(!1),[E,q]=t.useState(null),[_,w]=t.useState(!1),{enqueueSnackbar:M}=R(),z=ae(s=>s.auth.token),H=()=>{W({email:B,name:F}),b(1)};t.useEffect(()=>{(async()=>{var r,i,u,l;p(!0);try{const C={page:m,limit:x,email:f.email||void 0,firstName:f.name||void 0,sortBy:v||void 0},D=await k.get("/user",{params:C,headers:{Authorization:z}});d(((r=D.data.data)==null?void 0:r.results)||[]),S(((i=D.data.data)==null?void 0:i.totalResults)||0)}catch(C){c(((l=(u=C.response)==null?void 0:u.data)==null?void 0:l.message)||C.message)}finally{p(!1)}})()},[z,m,x,f,v,G]);const J=async(s,r)=>{var i,u;try{await k.patch(`/user/${s}`,{status:r},{headers:{Authorization:z}}),I(l=>!l),M(`User ${r==="enabled"?"enabled":"disabled"} successfully!`,{variant:"success"})}catch(l){M(((u=(i=l.response)==null?void 0:i.data)==null?void 0:u.message)||l.message||"Failed to update user status",{variant:"error"})}};return e.jsxs(te,{children:[e.jsx(j,{variant:"h2",mb:2,children:"User Control Panel"}),e.jsxs(P,{mb:2,display:"flex",alignItems:"center",gap:2,children:[e.jsx(U,{label:"Search by Email",size:"small",value:B,onChange:s=>L(s.target.value)}),e.jsx(U,{label:"Search by Name",size:"small",value:F,onChange:s=>O(s.target.value)}),e.jsxs(ne,{size:"small",sx:{minWidth:150},children:[e.jsx(re,{children:"Sort By"}),e.jsxs(ie,{value:v,label:"Sort By",onChange:s=>$(s.target.value+":asc"),children:[e.jsx(T,{value:"createdAt:desc",children:"None"}),e.jsx(T,{value:"firstName:asc",children:"Name"}),e.jsx(T,{value:"status:asc",children:"Status"})]})]}),e.jsx(g,{variant:"contained",color:"primary",onClick:H,children:"Search"})]}),o?e.jsx(j,{children:"Loading users..."}):h?e.jsx(j,{color:"error",children:h}):e.jsxs(e.Fragment,{children:[e.jsx(le,{children:e.jsxs(oe,{size:"small",children:[e.jsx(ce,{children:e.jsxs(A,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Designation"}),e.jsx(a,{children:"Organization"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Type"}),e.jsx(a,{children:"Status"}),e.jsx(a,{align:"center",children:"Action"})]})}),e.jsx(de,{children:y.map(s=>e.jsxs(A,{children:[e.jsxs(a,{children:[s.firstName," ",s.lastName]}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.designation}),e.jsx(a,{children:s.organization}),e.jsx(a,{children:s.role}),e.jsx(a,{children:s.type}),e.jsx(a,{children:e.jsx(he,{label:s.status,color:s.status==="enabled"?"success":"warning",size:"small"})}),e.jsx(a,{align:"center",justifyContent:"center",children:e.jsxs(P,{gap:1,display:"flex",justifyContent:"center",children:[e.jsx(me,{title:e.jsx(P,{children:Object.entries(s.permissions||{}).map(([r,i])=>e.jsxs(j,{variant:"caption",display:"block",children:[r,": ",i?"✅":"❌"]},r))}),arrow:!0,componentsProps:{tooltip:{sx:{bgcolor:"white",color:"black",boxShadow:1,borderRadius:1,fontSize:"0.75rem"}},arrow:{sx:{color:"white"}}},children:e.jsx(xe,{size:"small",color:"primary",children:e.jsx(ge,{})})}),e.jsx(g,{size:"small",variant:"outlined",onClick:()=>{q(s),w(!0)},children:"Change"}),e.jsx(g,{variant:"contained",color:s.status==="enabled"?"error":"success",size:"small",onClick:()=>J(s.id,s.status!=="enabled"?"enabled":"disabled"),children:s.status==="enabled"?"Disable":"Enable"})]})})]},s.id))})]})}),e.jsx(ue,{count:Math.ceil(n/x),page:m,onChange:(s,r)=>b(r),color:"primary",sx:{mt:2,display:"flex",justifyContent:"center"}})]}),E&&e.jsx(pe,{open:_,onClose:()=>w(!1),user:E,onSave:()=>I(s=>!s)})]})};export{Ce as default};
