import{V as Ne,U as Ue,t as ge,j as s,r as P,aq as Oe,ar as ie,y as me,Y as Ge,a7 as je,Z as We,af as Ee,as as ot,at as _e,au as ze,av as Pe,aw as He,b as rt,d as ue,ax as st,B as W,T as ee,ay as at,h as V,aa as qe,al as re,M as Te,az as nt,aA as it,aB as lt,D as ct}from"./index-B-97Stnr.js";import{m as U}from"./mapbox-gl-BDsxJc9Y.js";import{M as pt,g as Se}from"./index-Duvp4obE.js";import{d as dt}from"./dayjs.min-DRQ0Xc4u.js";import{u as ut,I as ft}from"./index-BzmCTyPk.js";import{T as Ve}from"./TextField-DXokT3Uj.js";import{B as le,C as Ze,I as gt}from"./InputLabel-bN84oSwy.js";import{I as Fe}from"./IconButton-DkWv8Gpw.js";import{I as mt}from"./IconBuildingCog-C_M6NVQD.js";import{u as yt,f as ht,F as vt}from"./OutlinedInput-DUxvNYun.js";import{F as ve,C as xe}from"./FormControlLabel-CQh9lVfY.js";import{S as xt}from"./Select-BkNAhdrO.js";import{M as wt}from"./MenuItem-BECs5rgy.js";import"./FormHelperText-iHdAZMns.js";function bt(e){return Ue("MuiAlert",e)}const Ie=Ne("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Ct=ge(s.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),Pt=ge(s.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),St=ge(s.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Mt=ge(s.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),kt=ge(s.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),Lt=e=>{const{variant:o,color:r,severity:t,classes:n}=e,a={root:["root",`color${je(r||t)}`,`${o}${je(r||t)}`,`${o}`],icon:["icon"],message:["message"],action:["action"]};return We(a,bt,n)},jt=me(Ee,{name:"MuiAlert",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.root,o[r.variant],o[`${r.variant}${je(r.color||r.severity)}`]]}})(ot(({theme:e})=>{const o=e.palette.mode==="light"?_e:ze,r=e.palette.mode==="light"?ze:_e;return{...e.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(Pe(["light"])).map(([t])=>({props:{colorSeverity:t,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${t}Color`]:o(e.palette[t].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${t}StandardBg`]:r(e.palette[t].light,.9),[`& .${Ie.icon}`]:e.vars?{color:e.vars.palette.Alert[`${t}IconColor`]}:{color:e.palette[t].main}}})),...Object.entries(e.palette).filter(Pe(["light"])).map(([t])=>({props:{colorSeverity:t,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${t}Color`]:o(e.palette[t].light,.6),border:`1px solid ${(e.vars||e).palette[t].light}`,[`& .${Ie.icon}`]:e.vars?{color:e.vars.palette.Alert[`${t}IconColor`]}:{color:e.palette[t].main}}})),...Object.entries(e.palette).filter(Pe(["dark"])).map(([t])=>({props:{colorSeverity:t,variant:"filled"},style:{fontWeight:e.typography.fontWeightMedium,...e.vars?{color:e.vars.palette.Alert[`${t}FilledColor`],backgroundColor:e.vars.palette.Alert[`${t}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[t].dark:e.palette[t].main,color:e.palette.getContrastText(e.palette[t].main)}}}))]}})),At=me("div",{name:"MuiAlert",slot:"Icon"})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Et=me("div",{name:"MuiAlert",slot:"Message"})({padding:"8px 0",minWidth:0,overflow:"auto"}),Ft=me("div",{name:"MuiAlert",slot:"Action"})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),Re={success:s.jsx(Ct,{fontSize:"inherit"}),warning:s.jsx(Pt,{fontSize:"inherit"}),error:s.jsx(St,{fontSize:"inherit"}),info:s.jsx(Mt,{fontSize:"inherit"})},$e=P.forwardRef(function(o,r){const t=Oe({props:o,name:"MuiAlert"}),{action:n,children:a,className:p,closeText:l="Close",color:d,components:u={},componentsProps:v={},icon:h,iconMapping:L=Re,onClose:S,role:b="alert",severity:x="success",slotProps:N={},slots:M={},variant:H="standard",...I}=t,m={...t,color:d,severity:x,variant:H,colorSeverity:d||x},D=Lt(m),R={slots:{closeButton:u.CloseButton,closeIcon:u.CloseIcon,...M},slotProps:{...v,...N}},[$,q]=ie("root",{ref:r,shouldForwardComponentProp:!0,className:Ge(D.root,p),elementType:jt,externalForwardedProps:{...R,...I},ownerState:m,additionalProps:{role:b,elevation:0}}),[Z,ne]=ie("icon",{className:D.icon,elementType:At,externalForwardedProps:R,ownerState:m}),[ce,pe]=ie("message",{className:D.message,elementType:Et,externalForwardedProps:R,ownerState:m}),[ae,K]=ie("action",{className:D.action,elementType:Ft,externalForwardedProps:R,ownerState:m}),[te,A]=ie("closeButton",{elementType:Fe,externalForwardedProps:R,ownerState:m}),[ye,de]=ie("closeIcon",{elementType:kt,externalForwardedProps:R,ownerState:m});return s.jsxs($,{...q,children:[h!==!1?s.jsx(Z,{...ne,children:h||L[x]||Re[x]}):null,s.jsx(ce,{...pe,children:a}),n!=null?s.jsx(ae,{...K,children:n}):null,n==null&&S?s.jsx(ae,{...K,children:s.jsx(te,{size:"small","aria-label":l,title:l,color:"inherit",onClick:S,...A,children:s.jsx(ye,{fontSize:"small",...de})})}):null]})});function Dt(e){return Ue("MuiFormGroup",e)}Ne("MuiFormGroup",["root","row","error"]);const _t=e=>{const{classes:o,row:r,error:t}=e;return We({root:["root",r&&"row",t&&"error"]},Dt,o)},zt=me("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.root,r.row&&o.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),Tt=P.forwardRef(function(o,r){const t=Oe({props:o,name:"MuiFormGroup"}),{className:n,row:a=!1,...p}=t,l=yt(),d=ht({props:t,muiFormControl:l,states:["error"]}),u={...t,row:a,error:d.error},v=_t(u);return s.jsx(zt,{className:Ge(v.root,n),ownerState:u,ref:r,...p})});/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var It=He("outline","trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ke=He("outline","x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]),G=63710088e-1,Ye={centimeters:G*100,centimetres:G*100,degrees:360/(2*Math.PI),feet:G*3.28084,inches:G*39.37,kilometers:G/1e3,kilometres:G/1e3,meters:G,metres:G,miles:G/1609.344,millimeters:G*1e3,millimetres:G*1e3,nauticalmiles:G/1852,radians:1,yards:G*1.0936};function we(e,o,r={}){const t={type:"Feature"};return(r.id===0||r.id)&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.properties=o||{},t.geometry=e,t}function be(e,o,r={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Be(e[0])||!Be(e[1]))throw new Error("coordinates must contain numbers");return we({type:"Point",coordinates:e},o,r)}function Rt(e,o,r={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return we({type:"LineString",coordinates:e},o,r)}function $t(e,o="kilometers"){const r=Ye[o];if(!r)throw new Error(o+" units is invalid");return e*r}function Bt(e,o="kilometers"){const r=Ye[o];if(!r)throw new Error(o+" units is invalid");return e/r}function Ae(e){return e%(2*Math.PI)*180/Math.PI}function Y(e){return e%360*Math.PI/180}function Be(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function fe(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Nt(e){return e.type==="Feature"?e.geometry:e}function Je(e,o,r={}){if(r.final===!0)return Ut(e,o);const t=fe(e),n=fe(o),a=Y(t[0]),p=Y(n[0]),l=Y(t[1]),d=Y(n[1]),u=Math.sin(p-a)*Math.cos(d),v=Math.cos(l)*Math.sin(d)-Math.sin(l)*Math.cos(d)*Math.cos(p-a);return Ae(Math.atan2(u,v))}function Ut(e,o){let r=Je(o,e);return r=(r+180)%360,r}function Ot(e,o,r,t={}){const n=fe(e),a=Y(n[0]),p=Y(n[1]),l=Y(r),d=Bt(o,t.units),u=Math.asin(Math.sin(p)*Math.cos(d)+Math.cos(p)*Math.sin(d)*Math.cos(l)),v=a+Math.atan2(Math.sin(l)*Math.sin(d)*Math.cos(p),Math.cos(d)-Math.sin(p)*Math.sin(u)),h=Ae(v),L=Ae(u);return be([h,L],t.properties)}function Xe(e,o,r={}){var t=fe(e),n=fe(o),a=Y(n[1]-t[1]),p=Y(n[0]-t[0]),l=Y(t[1]),d=Y(n[1]),u=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(p/2),2)*Math.cos(l)*Math.cos(d);return $t(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),r.units)}function Me(e,o,r={}){const n=Nt(e).coordinates;let a=0;for(let p=0;p<n.length&&!(o>=a&&p===n.length-1);p++)if(a>=o){const l=o-a;if(l){const d=Je(n[p],n[p-1])-180;return Ot(n[p],l,d,r)}else return be(n[p])}else a+=Xe(n[p],n[p+1],r);return be(n[n.length-1])}function De(e,o,r){if(e!==null)for(var t,n,a,p,l,d,u,v=0,h=0,L,S=e.type,b=S==="FeatureCollection",x=S==="Feature",N=b?e.features.length:1,M=0;M<N;M++){u=b?e.features[M].geometry:x?e.geometry:e,L=u?u.type==="GeometryCollection":!1,l=L?u.geometries.length:1;for(var H=0;H<l;H++){var I=0,m=0;if(p=L?u.geometries[H]:u,p!==null){d=p.coordinates;var D=p.type;switch(v=r&&(D==="Polygon"||D==="MultiPolygon")?1:0,D){case null:break;case"Point":if(o(d,h,M,I,m)===!1)return!1;h++,I++;break;case"LineString":case"MultiPoint":for(t=0;t<d.length;t++){if(o(d[t],h,M,I,m)===!1)return!1;h++,D==="MultiPoint"&&I++}D==="LineString"&&I++;break;case"Polygon":case"MultiLineString":for(t=0;t<d.length;t++){for(n=0;n<d[t].length-v;n++){if(o(d[t][n],h,M,I,m)===!1)return!1;h++}D==="MultiLineString"&&I++,D==="Polygon"&&m++}D==="Polygon"&&I++;break;case"MultiPolygon":for(t=0;t<d.length;t++){for(m=0,n=0;n<d[t].length;n++){for(a=0;a<d[t][n].length-v;a++){if(o(d[t][n][a],h,M,I,m)===!1)return!1;h++}m++}I++}break;case"GeometryCollection":for(t=0;t<p.geometries.length;t++)if(De(p.geometries[t],o,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Gt(e,o){var r,t,n,a,p,l,d,u,v,h,L=0,S=e.type==="FeatureCollection",b=e.type==="Feature",x=S?e.features.length:1;for(r=0;r<x;r++){for(l=S?e.features[r].geometry:b?e.geometry:e,u=S?e.features[r].properties:b?e.properties:{},v=S?e.features[r].bbox:b?e.bbox:void 0,h=S?e.features[r].id:b?e.id:void 0,d=l?l.type==="GeometryCollection":!1,p=d?l.geometries.length:1,n=0;n<p;n++){if(a=d?l.geometries[n]:l,a===null){if(o(null,L,u,v,h)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(o(a,L,u,v,h)===!1)return!1;break}case"GeometryCollection":{for(t=0;t<a.geometries.length;t++)if(o(a.geometries[t],L,u,v,h)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}function Wt(e,o){Gt(e,function(r,t,n,a,p){var l=r===null?null:r.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return o(we(r,n,{bbox:a,id:p}),t,0)===!1?!1:void 0}var d;switch(l){case"MultiPoint":d="Point";break;case"MultiLineString":d="LineString";break;case"MultiPolygon":d="Polygon";break}for(var u=0;u<r.coordinates.length;u++){var v=r.coordinates[u],h={type:d,coordinates:v};if(o(we(h,n),t,u)===!1)return!1}})}function Ht(e,o){Wt(e,function(r,t,n){var a=0;if(r.geometry){var p=r.geometry.type;if(!(p==="Point"||p==="MultiPoint")){var l,d=0,u=0,v=0;if(De(r,function(h,L,S,b,x){if(l===void 0||t>d||b>u||x>v){l=h,d=t,u=b,v=x,a=0;return}var N=Rt([l,h],r.properties);if(o(N,t,n,x,a)===!1)return!1;a++,l=h})===!1)return!1}}})}function qt(e,o,r){var t=r,n=!1;return Ht(e,function(a,p,l,d,u){n===!1&&r===void 0?t=a:t=o(t,a,p,l,d,u),n=!0}),t}function ke(e,o={}){let r=0,t=0,n=0;return De(e,function(a){r+=a[0],t+=a[1],n++},!0),be([r/n,t/n],o.properties)}function Le(e,o={}){return qt(e,(r,t)=>{const n=t.geometry.coordinates;return r+Xe(n[0],n[1],o)},0)}const Vt=({open:e=!1,onClose:o,onSave:r})=>{const[t,n]=P.useState(null),[a,p]=P.useState(!1),[l,d]=P.useState(0),[u,v]=P.useState({date:new Date().toISOString().split("T")[0],file:null}),{enqueueSnackbar:h}=rt(),L=ue(m=>m.auth.token),S=ue(m=>m.project.selectedProjectId);P.useEffect(()=>{e||(n(null),p(!1),d(0),v({date:new Date().toISOString().split("T")[0],file:null}))},[e]);const b=(m,D)=>{v(R=>({...R,[m]:D}))},x=m=>{m.length&&(n(m[0]),b("file",m[0]))},{getRootProps:N,getInputProps:M,isDragActive:H}=ut({onDrop:x,multiple:!1,accept:{"application/zip":[".zip"]}}),I=async()=>{var m,D,R;if(!u.file){h("Please select a file to upload.",{variant:"warning"});return}p(!0),d(0);try{const q=(await V.post("/work-day/get-url",{projectId:S,name:u.date,filename:u.file.name,contentType:u.file.type,size:u.file.size},{headers:{Authorization:L}})).data.data;if(console.log(q),q.uploadType==="single")await V.put(q.url,u.file,{headers:{"Content-Type":u.file.type},onUploadProgress:Z=>{const ne=Math.round(Z.loaded*100/Z.total);d(ne)}});else if(q.uploadType==="multipart"){const{parts:Z,uploadId:ne,key:ce,partSize:pe}=q,ae=[];let K=0;for(;K<u.file.size;){const A=Math.min(K+pe,u.file.size);ae.push(t.slice(K,A)),K=A}const te=[];for(let A=0;A<Z.length;A++){const de=(m=(await fetch(Z[A].url,{method:"PUT",body:ae[A]})).headers.get("ETag"))==null?void 0:m.replace(/"/g,"");te.push({PartNumber:Z[A].partNumber,ETag:de});const Ce=Math.round((A+1)/Z.length*100);d(Ce)}await V.post("/work-day/complete-upload",{projectId:S,name:u.date,key:ce,uploadId:ne,parts:te},{headers:{Authorization:L}})}h("Upload successful!",{variant:"success"}),q.uploadType==="single"&&h("SuccessFully Created Historical Data",{variant:"success"}),r&&r(),o()}catch($){console.log($),h(((R=(D=$==null?void 0:$.response)==null?void 0:D.data)==null?void 0:R.message)||$.message||"Upload failed.",{variant:"error"})}finally{p(!1),d(0)}};return s.jsx(st,{open:e,onClose:o,children:s.jsxs(W,{sx:{outline:"none",width:400,maxWidth:"90vw",bgcolor:"background.paper",borderRadius:2,boxShadow:24,mx:"auto",mt:"10vh",p:3},children:[s.jsx(ee,{variant:"h5",sx:{mb:2},children:"Upload New Capture Into Historical Data"}),s.jsxs(W,{sx:{display:"flex",flexDirection:"column",gap:2},children:[s.jsx(Ve,{label:"Date of Capture",type:"date",value:u.date,onChange:m=>b("date",m.target.value),fullWidth:!0,size:"small",disabled:a,InputLabelProps:{shrink:!0}}),s.jsxs(W,{...N(),sx:{border:"2px dashed #ccc",borderRadius:"8px",padding:4,textAlign:"center",cursor:a?"not-allowed":"pointer",backgroundColor:H?"#f0f0f0":"transparent",mb:2,opacity:a?.5:1,pointerEvents:a?"none":"auto"},children:[s.jsx("input",{...M()}),s.jsx(ft,{size:32}),s.jsx(ee,{variant:"h6",gutterBottom:!0,children:"Upload Zip File"}),s.jsx(ee,{variant:"body2",sx:{mb:2},children:"Drag & drop your .zip file or click below to browse"}),s.jsx(le,{variant:"outlined",disabled:a,children:"Browse Files"}),t&&s.jsxs(ee,{variant:"subtitle1",sx:{mt:1},children:["Selected: ",t.name]})]}),a&&s.jsxs(W,{children:[s.jsxs(ee,{variant:"body2",gutterBottom:!0,children:["Uploading... ",l,"%"]}),s.jsx(at,{variant:"determinate",value:l})]}),s.jsxs(W,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[s.jsx(le,{onClick:o,disabled:a,children:"Cancel"}),s.jsx(le,{variant:"contained",onClick:I,disabled:!u.file||a,startIcon:a&&s.jsx(Ze,{size:16}),children:a?"Uploading...":"Upload"})]})]})]})})},Zt=({commentInput:e,setCommentInput:o,addCommentLayer:r,setCommentFeatures:t,commentFeatures:n,handleDeleteComment:a,workDay:p})=>{var u,v,h,L,S;const l=ue(b=>b.auth.token),d=async(b,x)=>{try{const N=`comment-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,M={type:"Feature",geometry:e.feature.geometry,properties:{id:N,workDayId:p.id,comment:b,type:"comment",color:e.feature.properties.color,created:new Date().toISOString()}},H={geometry:M.geometry,properties:M.properties,featureType:M.properties.type,workDayId:p.id};(await V.post("/mapFeature",H,{headers:{Authorization:l}})).status===201&&re("Sucessfully Added Comment",{variant:"success"});const m=[...n,M];t(m),o({open:!1,feature:null,isEdit:!1,position:{x:0,y:0}}),new U.Popup().setLngLat(coordinates).setHTML(`<strong> ${b}</strong>`).addTo(mapboxMap)}catch(N){console.error(N)}};return s.jsx(qe,{in:e.open,children:s.jsxs(Ee,{elevation:4,sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e3,p:1.5,width:250,backgroundColor:"#ffffff",border:"1px solid #e0e0e0",borderRadius:1.5},children:[s.jsxs(W,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[s.jsx(ee,{variant:"subtitle2",sx:{fontSize:"0.875rem"},children:e.isEdit?"Edit Comment":"Add Comment"}),s.jsx(Fe,{size:"small",onClick:()=>o({open:!1,feature:null,isEdit:!1,position:{x:0,y:0}}),sx:{p:.5},children:s.jsx(Ke,{size:14})})]}),s.jsx(Ve,{autoFocus:!0,size:"small",fullWidth:!0,variant:"outlined",multiline:!0,rows:2,placeholder:"Enter comment...",value:((v=(u=e.feature)==null?void 0:u.properties)==null?void 0:v.comment)||"",onChange:b=>{if(e.feature){const x={...e.feature,properties:{...e.feature.properties,comment:b.target.value}};o({...e,feature:x})}},sx:{mb:1}}),s.jsxs(W,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.isEdit&&e.feature&&s.jsx(le,{size:"small",variant:"contained",color:"error",startIcon:s.jsx(It,{size:14}),onClick:()=>{a(e.feature)},sx:{fontSize:"0.75rem",py:.5},children:"Delete"}),s.jsx(le,{size:"small",variant:"contained",onClick:()=>{var b,x;return d(((x=(b=e.feature)==null?void 0:b.properties)==null?void 0:x.comment)||"")},disabled:!((S=(L=(h=e.feature)==null?void 0:h.properties)==null?void 0:L.comment)!=null&&S.trim()),sx:{fontSize:"0.75rem",py:.5},children:e.isEdit?"Update":"Add"})]})]})})},Kt=({areaPopup:e,setAreaPopup:o})=>s.jsx(qe,{in:e.open,children:s.jsxs(Ee,{elevation:4,sx:{position:"absolute",top:20,left:20,zIndex:2e3,p:1.5,minWidth:150,backgroundColor:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(8px)",border:"1px solid #3bb2d0",borderRadius:1.5},children:[s.jsxs(W,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[s.jsx(ee,{variant:"subtitle2",color:"primary",sx:{fontSize:"0.875rem"},children:"Area"}),s.jsx(Fe,{size:"small",onClick:()=>o({...e,open:!1}),sx:{p:.5},children:s.jsx(Ke,{size:14})})]}),s.jsx(ee,{variant:"caption",color:"textSecondary",children:e.message})]})});class Yt{constructor(o){if(typeof o=="function")this.onChange=o,this.initial="#3bb2d0",this.colors=["#ef4444","#f59e0b","#10b981","#3b82f6","#8b5cf6"];else{const{onChange:r,initial:t="#3bb2d0",colors:n=["#ef4444","#f59e0b","#10b981","#3b82f6","#8b5cf6"]}=o||{};this.onChange=r,this.initial=t,this.colors=n}this._map=null,this._container=null,this._palette=null,this._isOpen=!1,this._color=this.initial}onAdd(o){this._map=o;const r=document.createElement("div");r.className="mapboxgl-ctrl mapboxgl-ctrl-group",r.style.position="relative";const t=document.createElement("button");t.type="button",t.className="mapboxgl-ctrl-icon",t.setAttribute("aria-label","Color"),t.style.position="relative",t.style.width="30px",t.style.height="30px",t.style.display="inline-flex",t.style.alignItems="center",t.style.justifyContent="center";const n=document.createElement("span");n.style.width="14px",n.style.height="14px",n.style.borderRadius="50%",n.style.background=this._color,n.style.boxShadow="0 0 0 1px rgba(0,0,0,0.2) inset",t.appendChild(n),this._dot=n;const a=document.createElement("div");return a.style.position="absolute",a.style.top="0",a.style.right="100%",a.style.marginRight="8px",a.style.display="none",a.style.flexDirection="column",a.style.gap="6px",a.style.padding="8px",a.style.background="#fff",a.style.border="1px solid rgba(0,0,0,0.15)",a.style.borderRadius="8px",a.style.boxShadow="0 2px 8px rgba(0,0,0,0.12)",a.style.zIndex="2",this.colors.forEach(p=>{const l=document.createElement("button");l.type="button",l.style.width="22px",l.style.height="22px",l.style.borderRadius="50%",l.style.border="1px solid rgba(0,0,0,0.2)",l.style.background=p,l.style.cursor="pointer",l.title=p,l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this._selectColor(p)}),["mousedown","mouseup","dblclick","touchstart","touchend"].forEach(d=>l.addEventListener(d,u=>{u.preventDefault(),u.stopPropagation()})),a.appendChild(l)}),t.addEventListener("click",p=>{p.preventDefault(),p.stopPropagation(),this._isOpen=!this._isOpen,a.style.display=this._isOpen?"flex":"none"}),["mousedown","mouseup","dblclick","touchstart","touchend"].forEach(p=>a.addEventListener(p,l=>{l.preventDefault(),l.stopPropagation()})),this._outsideClick=p=>{r.contains(p.target)||(this._isOpen=!1,a.style.display="none")},document.addEventListener("click",this._outsideClick),r.appendChild(t),r.appendChild(a),this._container=r,this._palette=a,r}onRemove(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container),document.removeEventListener("click",this._outsideClick),this._map=null}_selectColor(o){if(this._color=o,this._dot&&(this._dot.style.background=o),typeof this.onChange=="function")try{this.onChange(o)}catch(r){console.error("ColorPicker onChange error:",r)}this._isOpen=!1,this._palette&&(this._palette.style.display="none")}}U.accessToken="pk.eyJ1IjoiaGlyYWtyYWoiLCJhIjoiY21icXd5eHRnMDNtaTJxczcxd2RmbTZwOCJ9.P6kpsuLMDdeK2DIMJZMrmw";const Jt=[{title:"Projects",to:"/project",icon:it},{title:"Project Name",icon:mt},{title:"Exterior(Map View)",icon:lt}];function go(){const e=P.useRef(null),o=P.useRef(null),r=P.useRef(null),[t,n]=P.useState(!1),[a,p]=P.useState(""),[l,d]=P.useState({orthomosaic:!0,annotations:!0,showComments:!0,showPolygons:!0,showLineString:!0}),[u,v]=P.useState(!1),[h,L]=P.useState([]),[S,b]=P.useState([]),[x,N]=P.useState(!1),[M,H]=P.useState({}),[I,m]=P.useState(null),[D,R]=P.useState(!1),[$,q]=P.useState([]),[Z,ne]=P.useState(""),[ce,pe]=P.useState({open:!1,area:0,position:{x:0,y:0},message:""}),[ae,K]=P.useState({open:!1,feature:null,isEdit:!1,position:{x:0,y:0}}),te=ue(i=>i.project.selectedProjectId),A=ue(i=>i.auth.token);P.useEffect(()=>{if(!te)return;(async()=>{var f,g,k,w,O,y,J,_;try{N(!0),m(null);const B=((g=(f=(await V.get("/work-day",{params:{projectId:te,status:"completed"},headers:{Authorization:A}})).data)==null?void 0:f.data)==null?void 0:g.results)||[];if(L(B.map(c=>c.name)),H(B[0]),b(B),B.length>0){p(B[0].name);const c=await V.get("/mapFeature",{params:{workDayId:B[0].id},headers:{Authorization:A}});((w=(k=c.data)==null?void 0:k.data)==null?void 0:w.results.length)!==0&&q((y=(O=c.data)==null?void 0:O.data)==null?void 0:y.results)}else m("No completed work days found for this project.")}catch(E){m(((_=(J=E.response)==null?void 0:J.data)==null?void 0:_.message)||"Failed to load project data. Please try again."),L([]),b([])}finally{N(!1)}})()},[te,A]),P.useEffect(()=>{if(!e.current||o.current)return;if(!U.accessToken){m("Mapbox API key is not configured.");return}const i=new U.Map({container:e.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[72.5714,23.0225],zoom:15,attributionControl:!1,preserveDrawingBuffer:!0,minZoom:0,maxZoom:23}),f="#3bb2d0";let g=f;const k=(y,J,_)=>{i.getLayer(y)&&i.setPaintProperty(y,J,_)},w=y=>{k("gl-draw-polygon-fill-active","fill-color",y),k("gl-draw-polygon-fill-active","fill-outline-color",y),k("gl-draw-polygon-stroke-active","line-color",y),k("gl-draw-line-active","line-color",y),k("gl-draw-point-mid","circle-color",y),k("gl-draw-point-vertex-active","circle-color",y),k("gl-draw-point-active","circle-color",y)},O=y=>{const _=["coalesce",["get","color"],f];return[{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","$type","Polygon"],["==","active","true"]],paint:{"fill-color":y,"fill-outline-color":y,"fill-opacity":.3}},{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","$type","Polygon"],["==","active","false"]],paint:{"fill-color":_,"fill-outline-color":_,"fill-opacity":.2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":y,"line-dasharray":[.2,2],"line-width":1}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","$type","Polygon"],["==","active","false"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":_,"line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],paint:{"line-color":y,"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","$type","LineString"],["==","active","false"]],paint:{"line-color":_,"line-width":2}},{id:"gl-draw-point-mid",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":4,"circle-color":y,"circle-stroke-color":"#ffffff","circle-stroke-width":2}},{id:"gl-draw-point-vertex-active",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["==","active","true"]],paint:{"circle-radius":6,"circle-color":y,"circle-stroke-color":"#ffffff","circle-stroke-width":3}},{id:"gl-draw-point-vertex-inactive",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["==","active","false"]],paint:{"circle-radius":5,"circle-color":_,"circle-stroke-color":"#ffffff","circle-stroke-width":2}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":4,"circle-color":y}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","false"]],paint:{"circle-radius":4,"circle-color":_}},{id:"gl-draw-point-comment",type:"circle",filter:["all",["==","active","false"],["==","meta","feature"],["==","user_type","comment"]],paint:{"circle-radius":4,"circle-color":_,"circle-stroke-color":"#fff","circle-stroke-width":2}}]};return i.on("load",()=>{o.current=i,n(!0),m(null),i.addControl(new U.FullscreenControl,"top-right"),i.addControl(new U.NavigationControl({visualizePitch:!0}),"top-right");const y=new U.ScaleControl({unit:"metric",maxWidth:100});i.addControl(y,"bottom-left"),setTimeout(()=>{const E=i.getContainer().querySelector(".mapboxgl-ctrl-scale");E&&(E.style.display="block",E.style.visibility="visible",E.style.opacity="1")},1e3);const J=new Yt(E=>{g=E||f,w(g)});i.addControl(J,"top-right");const _=new pt({displayControlsDefault:!1,controls:{polygon:!0,line_string:!0,point:!0,trash:!0},styles:O(g),userProperties:!0});i.addControl(_,"top-right"),r.current=_,w(g),i.on("draw.create",async E=>{var se;const B=M.id;E.features.forEach(C=>{_.setFeatureProperty(C.id,"color",g)});const c=(se=E.features)==null?void 0:se[0];if(c){if(o.current.__activePopup&&o.current.__activePopup.remove(),c.geometry.type==="LineString"){if(console.log(c,"<=== featuer LineSTring"),!c||c.geometry.type!=="LineString")return;const C=Le(c,{units:"meters"}),X=Me(c,C/2,{units:"meters"}).geometry.coordinates,F=`${C.toFixed(2)} m`;console.log(c,"<==== feature wow wow ow ow");const z=`polygon-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;c.properties.comment=F,c.properties.color=g,c.properties.id=z;try{const j={featureType:"line",geometry:c.geometry,properties:c.properties,workDayId:B};(await V.post("/mapFeature",j,{headers:{Authorization:A}})).status===201&&re("Line created ",{variant:"success"}),console.log(X,"<=== yo"),setTimeout(()=>{const Q=new U.Popup({closeButton:!0,offset:15}).setLngLat(X).setHTML(`<strong>Length: ${F}</strong>`).addTo(o.current);o.current.__activePopup=Q},0)}catch(j){console.error(j)}re(F,{variant:"success"})}if(c.geometry.type==="Polygon"){const C=Se.geometry(c.geometry),X=(C/1e6).toFixed(2),F=C.toFixed(2),z=`polygon-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,j=ke(c).geometry.coordinates;_.setFeatureProperty(c.id,"id",z),c.properties.color=g,c.properties.areaKm2=X,c.properties.areaM2=F,c.properties.id=z;try{const T={featureType:"polygon",geometry:c.geometry,properties:c.properties,workDayId:B};console.log(T,"<==== payload wow"),(await V.post("/mapFeature",T,{headers:{Authorization:A}})).status===201&&re("Polygon created ",{variant:"success"}),setTimeout(()=>{const oe=new U.Popup({closeButton:!0,offset:15}).setLngLat(j).setHTML(`<strong>Area: ${F} m²</strong>`).addTo(o.current);o.current.__activePopup=oe},0)}catch(T){console.error(T)}}if(c.geometry.type==="Point"){const C=i.getCanvas().getBoundingClientRect();K({open:!0,feature:{geometry:c.geometry,properties:{color:g}},isEdit:!1,position:{x:C.width/2,y:C.height/2}})}}}),i.on("draw.update",async E=>{var se,C,X;o.current.__activePopup&&o.current.__activePopup.remove(),console.log("updating something");const B=M.id,c=(se=E.features)==null?void 0:se[0];if(c){if(E.features.forEach(F=>{_.setFeatureProperty(F.id,"color",g)}),((C=c==null?void 0:c.geometry)==null?void 0:C.type)==="Polygon"){const F=Se.geometry(c.geometry),z=(F/1e6).toFixed(2),j=F.toFixed(2),T=ke(c).geometry.coordinates;i.getCanvas().getBoundingClientRect();const Q=new U.Popup({closeButton:!0,offset:15}).setLngLat(T).setHTML(`<strong>Area: ${j}</strong>`).addTo(o.current);o.current.__activePopup=Q,c.properties.color=g,c.properties.areaKm2=z,c.properties.areaM2=j;try{const oe={featureType:"polygon",geometry:c.geometry,properties:c.properties,workDayId:B};(await V.patch(`/mapFeature/propertyId/${c==null?void 0:c.properties.id}`,oe,{headers:{Authorization:A}})).status===200&&re("Polygon Updated ",{variant:"success"})}catch(oe){console.error(oe)}}if(((X=c==null?void 0:c.geometry)==null?void 0:X.type)==="LineString")try{const F=Le(c,{units:"kilometers"}),z=(F*1e3).toFixed(2),j=Me(c,F/2,{units:"kilometers"}).geometry.coordinates;if(j&&!j.some(Number.isNaN)){const oe=new U.Popup().setLngLat(j).setHTML(`<strong>${z} m</strong>`).addTo(i);o.current.__activePopup=oe}c.properties.color=g,c.properties.lengthKm=F.toFixed(2),c.properties.lengthM=z;const T={featureType:"line",geometry:c.geometry,properties:c.properties,workDayId:B};(await V.patch(`/mapFeature/propertyId/${c==null?void 0:c.properties.id}`,T,{headers:{Authorization:A}})).status===200&&re("Line Updated",{variant:"success"})}catch(F){console.error("Error updating line:",F)}}}),i.on("draw.delete",async E=>{o.current.__activePopup&&o.current.__activePopup.remove();const B=E.features[0];console.log(B,"<=== my feature"),console.log("Deleted features:",E.features);try{(await V.delete(`/mapfeature/propertyId/${B.properties.id}`)).status===200&&re("successfully removed feature",{variant:"success"})}catch(c){console.error("error removing feature",c)}}),i.on("click",E=>{var X,F;o.current.__activePopup&&o.current.__activePopup.remove();const c=["gl-draw-line-inactive","gl-draw-line-inactive.hot","gl-draw-line-active","gl-draw-line-active.hot","gl-draw-line-static","gl-draw-point-inactive","gl-draw-point-inactive.hot","gl-draw-point-active","gl-draw-point-active.hot","gl-draw-point-static","gl-draw-polygon-fill-inactive","gl-draw-polygon-fill-inactive.cold","gl-draw-polygon-fill-inactive.hot","gl-draw-polygon-fill-active","gl-draw-polygon-fill-static","gl-draw-polygon-stroke-inactive","gl-draw-polygon-stroke-inactive.cold","gl-draw-polygon-stroke-active","gl-draw-polygon-stroke-static"].filter(z=>i.getStyle().layers.some(j=>j.id===z)),se=i.queryRenderedFeatures(E.point,{layers:c});if(!se.length)return;const C=se[0];if(C.geometry.type==="Point"&&C.properties.user_type==="comment"){const z=C.geometry.coordinates.slice(),j=((X=C.properties)==null?void 0:X.comment)||((F=C.properties)==null?void 0:F.user_comment)||"",T=new U.Popup().setLngLat(z).setHTML(`<strong> ${j}</strong>`).addTo(i);o.current.__activePopup=T}if(C.geometry.type==="Polygon"){console.log(C,"<=== featuer agae ");const j=Se.geometry(C.geometry).toFixed(2),T=ke(C),Q=T.geometry.coordinates;console.log(T,"<==== centroid"),console.log(Q,"<=== coores"),new U.Popup().setLngLat(Q).setHTML(`<strong>Area: ${j} m2</strong>`).addTo(i)}if(C.geometry.type==="LineString"&&C.properties.mode!=="draw_polygon"){console.log(C,"<==== feature line string selection");const z=Le(C,{units:"kilometers"}),j=Me(C,z/2,{units:"kilometers"}).geometry.coordinates,T=z*1e3,Q=`${T.toFixed(2)} m`;if(j&&!j.some(Number.isNaN)){const oe=new U.Popup().setLngLat(j).setHTML(`<strong>${Q}</strong>`).addTo(i);o.current.__activePopup=oe}re(`Length: ${T.toFixed(2)} m`,{variant:"success"})}})}),i.on("sourcedata",y=>{var J;o.current.__activePopup&&o.current.__activePopup.remove(),(J=y.sourceId)!=null&&J.includes("ortho-")&&y.isSourceLoaded&&R(!1)}),()=>{i&&i.remove&&i.remove(),o.current=null,n(!1)}},[M]),P.useEffect(()=>{if(!a||!o.current||!t||!S.length)return;const i=S.find(w=>w.name===a);if(!i)return;ye(i.id);const f=r.current;o.current,f.deleteAll();const g={type:"FeatureCollection",features:$.map(w=>{const{geometry:O,properties:y}=w;return O?{type:"Feature",geometry:O,properties:{...y,comment:(y==null?void 0:y.comment)||"",color:(y==null?void 0:y.color)||(O.type==="Point"?"#FF0000":O.type==="LineString"?"#0000FF":"#00FF00"),message:(y==null?void 0:y.message)||"No message set"}}:null}).filter(Boolean)};let k={...g,features:[]};l.showComments&&k.features.push(...g.features.filter(w=>w.geometry.type==="Point")),l.showLineString&&k.features.push(...g.features.filter(w=>w.geometry.type==="LineString")),l.showPolygons&&k.features.push(...g.features.filter(w=>w.geometry.type==="Polygon")),k.features.length&&f.add(k),l.orthomosaic&&i.tileBaseUrl&&(console.log("nopitynope"),R(!0),de(i)),i.tileBounds&&Ce(i.tileBounds)},[a,t,l,S,$,M]);const ye=i=>{const f=o.current;if(!f)return;[`ortho-${i}`,"all-features-points","all-features-lines","all-features-polygons","all-features-polygons-outline","comment-labels"].forEach(w=>{f.getLayer(w)&&(console.log("Removing layer:",w),f.removeLayer(w))}),[`ortho-${i}`,"all-features"].forEach(w=>{f.getSource(w)&&(console.log("Removing source:",w),f.removeSource(w))})},de=i=>{const f=o.current;if(!f||!i.tileBaseUrl)return;const g=`ortho-${i.id}`;try{f.getLayer(g)&&f.removeLayer(g),f.getSource(g)&&f.removeSource(g),f.addSource(g,{type:"raster",tiles:[`${i.tileBaseUrl}/{z}/{x}/{y}.png`],tileSize:256,minzoom:18,maxzoom:24});const k=f.getStyle().layers.find(w=>w.id.startsWith("gl-draw-")).id;f.addLayer({id:g,type:"raster",source:g,paint:{"raster-opacity":l.orthomosaic?1:0,"raster-brightness-min":0,"raster-brightness-max":1}},k),console.log("Raster layer added:",g,"URL:",i.tileBaseUrl),setTimeout(()=>{const w=f.getLayer(g),O=f.getSource(g);console.log("Layer check:",{layerExists:!!w,sourceExists:!!O,layerVisible:f.getLayoutProperty(g,"visibility")!=="none",paintOpacity:f.getPaintProperty(g,"raster-opacity")})},1e3),R(!1)}catch(k){console.error("Error adding tile layer:",k),m("Failed to load orthomosaic tiles."),R(!1)}},Ce=i=>{const f=o.current;if(!f)return;const{north:g,south:k,east:w,west:O}=i;f.fitBounds([[O,k],[w,g]],{padding:50,maxZoom:18})},he=i=>{d(f=>({...f,[i.target.name]:i.target.checked}))},Qe=i=>{p(i.target.value);const f=S.find(g=>g.name===i.target.value);H(f)},et=i=>{const f=o.current;if(!(!f||!t)){if(console.log("Updating comment layer with features:",i),f.getLayer("comment-points")&&(console.log("Removing existing comment layer"),f.removeLayer("comment-points")),f.getSource("comments")&&(console.log("Removing existing comment source"),f.removeSource("comments")),console.log("checking features ",i),i&&i.length>0&&l.showComments){console.log("Adding new comment layer with",i.length,"features"),f.addSource("comments",{type:"geojson",data:{type:"FeatureCollection",features:i}}),f.addLayer({id:"comment-points",type:"symbol",source:"comments",layout:{"icon-image":"marker-15","icon-size":1.5,"text-field":["get","comment"],"text-offset":[0,1.5],"text-anchor":"top"},paint:{"text-size":.5,"text-color":"#000","text-halo-color":"#fff","text-halo-width":2}});const g=f.getLayer("comment-points");g&&console.log("Comment layer added successfully with ID:",g.id)}else console.log("No features to display, comment layer removed");f.isStyleLoaded()&&f.triggerRepaint(),console.log("Comment layer update complete")}},tt=async i=>{console.log("=== COMMENT DELETION DEBUG ==="),console.log("Attempting to delete comment",i),console.log("Current commentFeatures:",$),console.log($[0].properties.comment),console.log(i.properties.comment);const f=$.filter(g=>g.properties.id!==i.properties.id);try{await V.delete(`/mapFeature/propertyId/${i.properties.id}`,{headers:{Authorization:A}})}catch(g){console.error(g)}console.log("Updated commentFeatures after deletion:",f),re("Successfully Removed Comment",{variant:"success"}),q(f),refreshCommentLayer(),K({open:!1,feature:null,isEdit:!1,position:{x:0,y:0}}),console.log("=== END DELETION DEBUG ===")};return te?s.jsxs(Te,{children:[s.jsxs(W,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[s.jsx(ee,{variant:"h1",gutterBottom:!0,children:"Exterior (Map View)"}),s.jsx(le,{variant:"contained",onClick:()=>v(!0),disabled:x,children:"Upload New"})]}),s.jsx(Vt,{open:u,onClose:()=>v(!1)}),s.jsx(nt,{links:Jt,card:!0,custom:!0,rightAlign:!1}),s.jsx(ct,{sx:{my:2}}),s.jsxs(W,{display:"flex",height:"calc(100vh - 320px)",gap:1,children:[s.jsxs(W,{sx:{width:"250px",pr:2,height:"100%"},children:[s.jsx(ee,{onClick:()=>{console.log($,"<=== comment features"),console.log(M.id,">====== selected workday ID")},variant:"h3",gutterBottom:!0,children:"Layers"}),s.jsxs(Tt,{children:[s.jsx(ve,{control:s.jsx(xe,{checked:l.orthomosaic,onChange:he,name:"orthomosaic",disabled:x}),label:"Orthomosaic"}),s.jsx(ve,{control:s.jsx(xe,{checked:l.showLineString,onChange:he,name:"showLineString",disabled:x}),label:"Show Lines"}),s.jsx(ve,{control:s.jsx(xe,{checked:l.showPolygons,onChange:he,name:"showPolygons",disabled:x}),label:"Show Polygons"}),s.jsx(ve,{control:s.jsx(xe,{checked:l.showComments,onChange:he,name:"showComments",disabled:x}),label:"Show Comments"})]}),s.jsxs(vt,{fullWidth:!0,sx:{mt:3},children:[s.jsx(gt,{children:"Historical Data"}),s.jsx(xt,{value:a||"",onChange:Qe,label:"Historical Data",disabled:x||h.length===0,children:h.map(i=>s.jsx(wt,{value:i,children:dt(i).format("DD-MM-YYYY")},i))})]}),x&&s.jsx(W,{sx:{display:"flex",justifyContent:"center",mt:2},children:s.jsx(Ze,{size:24})}),!x&&h.length===0&&s.jsx($e,{severity:"info",sx:{mt:2},children:"No historical data available for this project."})]}),s.jsx(W,{ref:e,sx:{flex:1,borderRadius:2,overflow:"hidden",height:"100%",position:"relative",border:"1px solid #e0e0e0","& .mapboxgl-ctrl-scale":{border:"2px solid #333",borderTop:"none",color:"#333",backgroundColor:"rgba(255, 255, 255, 0.8)",padding:"2px 6px",fontSize:"12px",fontWeight:"bold"}},children:s.jsx(Kt,{areaPopup:ce,setAreaPopup:pe,text:Z||""})}),s.jsx(Zt,{addCommentLayer:et,setCommentFeatures:q,commentInput:ae,setCommentInput:K,commentFeatures:$,handleDeleteComment:tt,workDay:M})]})]}):s.jsx(Te,{children:s.jsx($e,{severity:"warning",children:"No project selected. Please select a project first."})})}export{go as default};
