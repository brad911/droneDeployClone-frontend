import{z as V,j as e,a as W,c as E,R as H,B as b,T as D,U as R,S as I,k as z,V as p,m as G,d as U,r as j,G as h,W as $,F as q,I as J,x as K,M as A,X as Q,Y as Z,l as ee}from"./index-BS7x6V1Y.js";import{P as te}from"./Person-Dbyt9gk_.js";import{C as ne}from"./CardMedia-BWn1o9KL.js";import{t as w,c as se,n as X,g as N,a as ae,e as re,m as O,b as T}from"./en-US-CRQByS1p.js";import{e as ie,a as ce}from"./endOfMonth-4FTE1eXr.js";const oe=V(e.jsx("path",{d:"M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2m-11-4 2.03 2.71L16 11l4 5H8zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6z"}));function P(t,a){const n=+w(t)-+w(a);return n<0?-1:n>0?1:n}function le(t){return se(t,Date.now())}function ue(t,a,n){const[i,s]=X(n==null?void 0:n.in,t,a),c=i.getFullYear()-s.getFullYear(),u=i.getMonth()-s.getMonth();return c*12+u}function de(t){return a=>{const i=(t?Math[t]:Math.trunc)(a);return i===0?0:i}}function fe(t,a){return+w(t)-+w(a)}function he(t,a){const n=w(t,a==null?void 0:a.in);return+ie(n,a)==+ce(n,a)}function me(t,a,n){const[i,s,c]=X(n==null?void 0:n.in,t,t,a),u=P(s,c),r=Math.abs(ue(s,c));if(r<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-u*r);let x=P(s,c)===-u;he(i)&&r===1&&P(i,c)===1&&(x=!1);const g=u*(r-+x);return g===0?0:g}function xe(t,a,n){const i=fe(t,a)/1e3;return de(n==null?void 0:n.roundingMethod)(i)}function ge(t,a,n){const i=ae(),s=(n==null?void 0:n.locale)??i.locale??re,c=2520,u=P(t,a);if(isNaN(u))throw new RangeError("Invalid time value");const r=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:u}),[x,g]=X(n==null?void 0:n.in,...u>0?[a,t]:[t,a]),m=xe(g,x),C=(N(g)-N(x))/1e3,o=Math.round((m-C)/60);let f;if(o<2)return n!=null&&n.includeSeconds?m<5?s.formatDistance("lessThanXSeconds",5,r):m<10?s.formatDistance("lessThanXSeconds",10,r):m<20?s.formatDistance("lessThanXSeconds",20,r):m<40?s.formatDistance("halfAMinute",0,r):m<60?s.formatDistance("lessThanXMinutes",1,r):s.formatDistance("xMinutes",1,r):o===0?s.formatDistance("lessThanXMinutes",1,r):s.formatDistance("xMinutes",o,r);if(o<45)return s.formatDistance("xMinutes",o,r);if(o<90)return s.formatDistance("aboutXHours",1,r);if(o<O){const d=Math.round(o/60);return s.formatDistance("aboutXHours",d,r)}else{if(o<c)return s.formatDistance("xDays",1,r);if(o<T){const d=Math.round(o/O);return s.formatDistance("xDays",d,r)}else if(o<T*2)return f=Math.round(o/T),s.formatDistance("aboutXMonths",f,r)}if(f=me(g,x),f<12){const d=Math.round(o/T);return s.formatDistance("xMonths",d,r)}else{const d=f%12,M=Math.trunc(f/12);return d<3?s.formatDistance("aboutXYears",M,r):d<9?s.formatDistance("overXYears",M,r):s.formatDistance("almostXYears",M+1,r)}}function je(t,a){return ge(t,le(t),a)}const De="/assets/conture-map-DVTY2EDp.jpg",Me=({project:t,count:a})=>{const n=W(),i=E(),s=()=>{const c=t._id||t.id;i(p({id:c,name:t.name})),n(`/project/${c}/View`)};return e.jsxs(H,{elevation:4,sx:{maxHeight:220,position:"relative",width:320,maxWidth:320,borderRadius:3,overflow:"hidden",cursor:"pointer",transition:"0.3s","&:hover":{boxShadow:6}},onClick:s,children:[e.jsxs(b,{sx:{position:"relative",height:140},children:[e.jsx(ne,{component:"img",height:"140",image:De,alt:t==null?void 0:t.name,sx:{objectFit:"cover",filter:"brightness(60%)"}}),e.jsx(b,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",px:2},children:e.jsx(D,{variant:"subtitle1",fontWeight:700,color:"white",noWrap:!0,children:t==null?void 0:t.name})})]}),e.jsx(R,{sx:{pt:1,pb:1},children:e.jsxs(I,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(I,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(I,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(oe,{fontSize:"small"}),e.jsx(D,{variant:"caption",children:t==null?void 0:t.location})]}),e.jsxs(I,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(te,{fontSize:"small"}),e.jsx(D,{variant:"caption",children:a})]}),e.jsx(I,{children:e.jsx(D,{variant:"caption",fontSize:8,color:"text.secondary",children:t!=null&&t.createdAt?`${je(new Date(t==null?void 0:t.createdAt),{addSuffix:!0})}`:"Time unknown"})})]}),e.jsx(z,{size:"small",onClick:c=>{c.stopPropagation(),s()},children:"View"})]})})]})};function Ce(){const t=G(),a=W(),n=U(l=>l.auth),[i,s]=j.useState(""),[c,u]=j.useState(""),[r,x]=j.useState([]),[g,m]=j.useState(!1),[C,o]=j.useState(null),[f,d]=j.useState(1),[M,B]=j.useState(1),L=12,F=async(l="",S="",_=1)=>{var k;m(!0),o(null);try{const v={email:n.user.email,status:"active",page:_,limit:L};l&&(v.search=l),S&&(v.sortBy=S);const y=(k=(await ee.get("/project-members",{params:v,headers:{Authorization:n.token}})).data)==null?void 0:k.data;x((y==null?void 0:y.results)||[]),B((y==null?void 0:y.totalPages)||1)}catch(v){o(v.message||"Failed to fetch projects")}finally{m(!1)}};j.useEffect(()=>{F(i,c,f)},[f]);const Y=()=>{d(1),F(i,c,1)};return e.jsxs(b,{p:3,children:[e.jsxs(h,{container:!0,spacing:2,alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsx(h,{item:!0,xs:12,md:3,children:e.jsx(D,{variant:"h2",fontWeight:600,children:"All Projects"})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsxs(h,{container:!0,justifyContent:"center",alignItems:"center",spacing:2,children:[e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsx($,{label:"Search by Name",variant:"outlined",size:"small",fullWidth:!0,value:i,onChange:l=>s(l.target.value)})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(q,{sx:{...t.typography.customSelect2,minWidth:"100px"},fullWidth:!0,children:[e.jsx(J,{children:"Sort By"}),e.jsxs(K,{size:"small",value:c,label:"Sort By",onChange:l=>u(l.target.value),children:[e.jsx(A,{value:"name",children:"Name"}),e.jsx(A,{value:"images",children:"Date"})]})]})}),e.jsx(h,{item:!0,xs:12,sm:2,children:e.jsx(z,{variant:"contained",fullWidth:!0,onClick:Y,children:"Search"})})]})}),e.jsx(h,{item:!0,xs:12,md:3,textAlign:{xs:"left",md:"right"},children:e.jsx(z,{variant:"contained",onClick:()=>a("/createProject"),startIcon:e.jsx(Q,{}),color:"primary",children:"Create New Project"})})]}),g?e.jsx(D,{variant:"body1",children:"Loading projects..."}):C?e.jsx(D,{color:"error",children:C}):r.length===0?e.jsx(b,{mt:6,textAlign:"center",children:e.jsx(D,{variant:"h6",color:"text.secondary",children:"No projects found. Create a project to start working."})}):e.jsxs(e.Fragment,{children:[e.jsx(h,{container:!0,spacing:3,children:r.map((l,S)=>e.jsx(h,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(Me,{project:l.projectId,count:l.memberCount})},S))}),M>1&&e.jsx(b,{mt:4,display:"flex",justifyContent:"center",children:e.jsx(Z,{count:M,page:f,onChange:(l,S)=>d(S),color:"primary"})})]})]})}export{Ce as default};
