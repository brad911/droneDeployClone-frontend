import{y as V,j as e,a as O,c as Y,Q as E,B as w,T as D,R as H,S as I,i as p,U as R,l as G,d as U,r as j,G as h,V as $,F as Q,I as q,w as J,M as k,W as K,X as Z,k as ee}from"./index-gpMRNU1w.js";import{P as te}from"./Person-nLdeDYlx.js";import{C as ne}from"./CardMedia-BYBiJ3jb.js";import{t as b,c as se,n as z,g as A,a as re,e as ae,m as N,b as T}from"./en-US-CRQByS1p.js";import{e as ie,a as ce}from"./endOfMonth-4FTE1eXr.js";const oe=V(e.jsx("path",{d:"M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2m-11-4 2.03 2.71L16 11l4 5H8zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6z"}));function P(t,r){const n=+b(t)-+b(r);return n<0?-1:n>0?1:n}function le(t){return se(t,Date.now())}function ue(t,r,n){const[i,s]=z(n==null?void 0:n.in,t,r),c=i.getFullYear()-s.getFullYear(),u=i.getMonth()-s.getMonth();return c*12+u}function de(t){return r=>{const i=(t?Math[t]:Math.trunc)(r);return i===0?0:i}}function fe(t,r){return+b(t)-+b(r)}function he(t,r){const n=b(t,r==null?void 0:r.in);return+ie(n,r)==+ce(n,r)}function me(t,r,n){const[i,s,c]=z(n==null?void 0:n.in,t,t,r),u=P(s,c),a=Math.abs(ue(s,c));if(a<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-u*a);let x=P(s,c)===-u;he(i)&&a===1&&P(i,c)===1&&(x=!1);const g=u*(a-+x);return g===0?0:g}function xe(t,r,n){const i=fe(t,r)/1e3;return de(n==null?void 0:n.roundingMethod)(i)}function ge(t,r,n){const i=re(),s=(n==null?void 0:n.locale)??i.locale??ae,c=2520,u=P(t,r);if(isNaN(u))throw new RangeError("Invalid time value");const a=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:u}),[x,g]=z(n==null?void 0:n.in,...u>0?[r,t]:[t,r]),m=xe(g,x),C=(A(g)-A(x))/1e3,o=Math.round((m-C)/60);let f;if(o<2)return n!=null&&n.includeSeconds?m<5?s.formatDistance("lessThanXSeconds",5,a):m<10?s.formatDistance("lessThanXSeconds",10,a):m<20?s.formatDistance("lessThanXSeconds",20,a):m<40?s.formatDistance("halfAMinute",0,a):m<60?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",1,a):o===0?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",o,a);if(o<45)return s.formatDistance("xMinutes",o,a);if(o<90)return s.formatDistance("aboutXHours",1,a);if(o<N){const d=Math.round(o/60);return s.formatDistance("aboutXHours",d,a)}else{if(o<c)return s.formatDistance("xDays",1,a);if(o<T){const d=Math.round(o/N);return s.formatDistance("xDays",d,a)}else if(o<T*2)return f=Math.round(o/T),s.formatDistance("aboutXMonths",f,a)}if(f=me(g,x),f<12){const d=Math.round(o/T);return s.formatDistance("xMonths",d,a)}else{const d=f%12,M=Math.trunc(f/12);return d<3?s.formatDistance("aboutXYears",M,a):d<9?s.formatDistance("overXYears",M,a):s.formatDistance("almostXYears",M+1,a)}}function je(t,r){return ge(t,le(t),r)}const De="/assets/conture-map-DVTY2EDp.jpg",Me=({project:t,count:r})=>{const n=O(),i=Y(),s=()=>{const c=t._id||t.id;i(R({id:c,name:t.name})),n(`/project/${c}/View`)};return e.jsxs(E,{elevation:4,sx:{maxHeight:220,position:"relative",width:320,maxWidth:320,borderRadius:3,overflow:"hidden",cursor:"pointer",transition:"0.3s","&:hover":{boxShadow:6}},onClick:s,children:[e.jsxs(w,{sx:{position:"relative",height:140},children:[e.jsx(ne,{component:"img",height:"140",image:De,alt:t==null?void 0:t.name,sx:{objectFit:"cover",filter:"brightness(60%)"}}),e.jsx(w,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",px:2},children:e.jsx(D,{variant:"subtitle1",fontWeight:700,color:"white",noWrap:!0,children:t==null?void 0:t.name})})]}),e.jsx(H,{sx:{pt:1,pb:1},children:e.jsxs(I,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(I,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(I,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(oe,{fontSize:"small"}),e.jsx(D,{variant:"caption",children:t.location})]}),e.jsxs(I,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(te,{fontSize:"small"}),e.jsx(D,{variant:"caption",children:r})]}),e.jsx(I,{children:e.jsx(D,{variant:"caption",fontSize:8,color:"text.secondary",children:t.createdAt?`${je(new Date(t.createdAt),{addSuffix:!0})}`:"Time unknown"})})]}),e.jsx(p,{size:"small",onClick:c=>{c.stopPropagation(),s()},children:"View"})]})})]})};function Ce(){const t=G(),r=O(),n=U(l=>l.auth),[i,s]=j.useState(""),[c,u]=j.useState(""),[a,x]=j.useState([]),[g,m]=j.useState(!1),[C,o]=j.useState(null),[f,d]=j.useState(1),[M,W]=j.useState(1),B=12,X=async(l="",S="",_=1)=>{var F;m(!0),o(null);try{const v={email:n.user.email,status:"active",page:_,limit:B};l&&(v.search=l),S&&(v.sortBy=S);const y=(F=(await ee.get("/project-members",{params:v,headers:{Authorization:n.token}})).data)==null?void 0:F.data;x((y==null?void 0:y.results)||[]),W((y==null?void 0:y.totalPages)||1)}catch(v){o(v.message||"Failed to fetch projects")}finally{m(!1)}};j.useEffect(()=>{X(i,c,f)},[f]);const L=()=>{d(1),X(i,c,1)};return e.jsxs(w,{p:3,children:[e.jsxs(h,{container:!0,spacing:2,alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsx(h,{item:!0,xs:12,md:3,children:e.jsx(D,{variant:"h2",fontWeight:600,children:"All Projects"})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsxs(h,{container:!0,justifyContent:"center",alignItems:"center",spacing:2,children:[e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsx($,{label:"Search by Name",variant:"outlined",size:"small",fullWidth:!0,value:i,onChange:l=>s(l.target.value)})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(Q,{sx:{...t.typography.customSelect2,minWidth:"100px"},fullWidth:!0,children:[e.jsx(q,{children:"Sort By"}),e.jsxs(J,{size:"small",value:c,label:"Sort By",onChange:l=>u(l.target.value),children:[e.jsx(k,{value:"name",children:"Name"}),e.jsx(k,{value:"images",children:"Date"})]})]})}),e.jsx(h,{item:!0,xs:12,sm:2,children:e.jsx(p,{variant:"contained",fullWidth:!0,onClick:L,children:"Search"})})]})}),e.jsx(h,{item:!0,xs:12,md:3,textAlign:{xs:"left",md:"right"},children:e.jsx(p,{variant:"contained",onClick:()=>r("/createProject"),startIcon:e.jsx(K,{}),color:"primary",children:"Create New Project"})})]}),g?e.jsx(D,{variant:"body1",children:"Loading projects..."}):C?e.jsx(D,{color:"error",children:C}):a.length===0?e.jsx(w,{mt:6,textAlign:"center",children:e.jsx(D,{variant:"h6",color:"text.secondary",children:"No projects found. Create a project to start working."})}):e.jsxs(e.Fragment,{children:[e.jsx(h,{container:!0,spacing:3,children:a.map((l,S)=>e.jsx(h,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(Me,{project:l.projectId,count:l.memberCount})},S))}),M>1&&e.jsx(w,{mt:4,display:"flex",justifyContent:"center",children:e.jsx(Z,{count:M,page:f,onChange:(l,S)=>d(S),color:"primary"})})]})]})}export{Ce as default};
